<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Ittai Eres" />

<meta name="date" content="2018-01-23" />

<title>Hi-C Data Normalization and Initial Quality Control, Juicer</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Hi-C</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jdblischak/workflowr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Hi-C Data Normalization and Initial Quality Control, Juicer</h1>
<h4 class="author"><em>Ittai Eres</em></h4>
<h4 class="date"><em>2018-01-23</em></h4>

</div>


<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2018-09-25</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> 9058484</p>
<!-- Add your analysis here -->
<div id="initial-data-read-in-and-quality-control" class="section level3">
<h3>Initial Data read-in and quality control</h3>
<p>First, I read in the data and normalize it with cyclic pairwise loess normalization. Then I look at histograms of the distributions of the contact frequencies on an individual-by-individual basis, to see if they are comparable. I also look at a plot of the mean vs. the variance as an additional quality control metric; this is typically done on RNA-seq count data. In that case, it’s done to check if the normalized data are distributed in a particular fashion (e.g. a poisson model would have a linear mean-variance relationship). In the limma/voom pipeline, count data are log-cpm transformed and a loess trend line of variance vs. mean is then fit to create weights for individual genes to be fed into linear modeling with limma. Since this is not a QC metric typically used for Hi-C data, the only thing I hope to see is no particularly strong relationship between variance and mean.</p>
<pre class="r"><code>###Read in VC and KR normalized data, normalize each with cyclic loess (pairwise), clean it from any rows that have missing values.
full.KR &lt;- fread(&quot;~/Desktop/Hi-C/final.juicer.10kb.KR&quot;, header=TRUE, stringsAsFactors = FALSE, data.table=FALSE, showProgress = FALSE) #Start w/ roughly 31.5k hits here
full.VC &lt;- fread(&quot;~/Desktop/Hi-C/final.juicer.10kb.VC&quot;, header=TRUE, stringsAsFactors = FALSE, data.table = FALSE, showProgress = FALSE) #~84k hits...

#Note that many more hits show up as significant under the VC normalization paradigm than do under KR balancing. This is especially bad for A-21792 for some reason.

#Subsetting down to only complete cases (I.E. none of the individuals have NA values goes to ~28k and ~77k hits for KR and VC, respectively. Reductions of both ~10%.)
full.KR &lt;- full.KR[complete.cases(full.KR[,112:119]),]
full.VC &lt;- full.VC[complete.cases(full.VC[,112:119]),]

#Visualize both.
boxplot(full.KR[,112:119], ylim=c(0, 30), horizontal = TRUE, main=&quot;KR Distributions&quot;)</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>boxplot(full.VC[,112:119], ylim=c(0, 30), horizontal=TRUE, main=&quot;VC Distributions&quot;)
KR.contacts &lt;- full.KR[,112:119]
VC.contacts &lt;- full.VC[,112:119]

###Pearson is a product moment correlation, meaning it evaluates the relationship b/t two continuous variables. Spearman is a rank-order correlation, is mainly evaluating monotonic rlationship b/t two continuous/ordinal variables (variables change together, but not necessarily at a constant rate). It&#39;s based on ranked values for each variable, rather than the raw data itself, and is thus not quite as precise IMO. Hence here I optimize my normalization schemes WRT seeing proper clustering in a Pearson correlation heatmap. OR I do it WRT a Spearman heatmap b/c Pearson is more quantitative and thus harder to fine-tune, and keeps messing up here--can&#39;t find a single normalization scheme that gives good clustering that isn&#39;t super dirty on Pearson.
###For now, just use Spearman correlations 
full.contacts.VC &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.28, iterations=3, method=&quot;pairs&quot;))#Pearson clusters properly, but correlation values are not very pretty for separation. Same situation in Spearman but slightly less ugly. #6 iterations of 0.1 aren&#39;t bad, and can also get beautiful results with method=&quot;fast&quot; instead of pairs (but this takes loess to the average of all the data so that&#39;s why, maybe not as valid). 0.21 and 0.28 spans also worth checking? They produce nice looking boxplots but not great looking heatmaps in either case...

#VC Correlations
corheat &lt;- cor(full.contacts.VC, use=&quot;complete.obs&quot;, method=&quot;pearson&quot;)
corheats &lt;- cor(full.contacts.VC, use=&quot;complete.obs&quot;, method=&quot;spearman&quot;)
colnames(corheat) &lt;- c(&quot;A_HF&quot;, &quot;B_HM&quot;, &quot;C_CM&quot;, &quot;D_CF&quot;, &quot;E_HM&quot;, &quot;F_HF&quot;, &quot;G_CM&quot;, &quot;H_CF&quot;)
rownames(corheat) &lt;- colnames(corheat)
colnames(corheats) &lt;- colnames(corheat)
rownames(corheats) &lt;- colnames(corheat)

#VC Clustering
heatmaply(corheat, main=&quot;Pairwise Pearson Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Clusters well, but not super distinct.</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-2.png" width="672" style="display: block; margin: auto;" /><div id="e21a752f1db6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21a752f1db6">{"x":{"data":[{"x":[4.625,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"y":[0.302778065504197,0.302778065504197,null,0.302778065504197,0.201403064219327,null,0.201403064219327,0.201403064219327,null,0.201403064219327,0.169072159733214,null,0.169072159733214,0.169072159733214,null,0.169072159733214,0.0832212592136645,null,0.0832212592136645,0.0832212592136645,null,0.0832212592136645,0,null,0.0832212592136645,0.0832212592136645,null,0.0832212592136645,0,null,0.169072159733214,0.169072159733214,null,0.169072159733214,0,null,0.201403064219327,0.201403064219327,null,0.201403064219327,0],"text":["y: 0.30277807","y: 0.30277807",null,"y: 0.30277807","y: 0.30277807",null,"y: 0.20140306","y: 0.20140306",null,"y: 0.20140306","y: 0.20140306",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.20140306","y: 0.20140306",null,"y: 0.20140306","y: 0.20140306"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.625,2.125,null,2.125,2.125,null,2.125,1,null,1,1,null,2.125,3.25,null,3.25,3.25,null,3.25,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.25,4,null,4,4],"y":[0.302778065504197,0.302778065504197,null,0.302778065504197,0.0995692696327528,null,0.0995692696327528,0.0995692696327528,null,0.0995692696327528,0,null,0.0995692696327528,0.0995692696327528,null,0.0995692696327528,0.0551113924680503,null,0.0551113924680503,0.0551113924680503,null,0.0551113924680503,0.0329636570421535,null,0.0329636570421535,0.0329636570421535,null,0.0329636570421535,0,null,0.0329636570421535,0.0329636570421535,null,0.0329636570421535,0,null,0.0551113924680503,0.0551113924680503,null,0.0551113924680503,0],"text":["y: 0.30277807","y: 0.30277807",null,"y: 0.30277807","y: 0.30277807",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.05511139","y: 0.05511139",null,"y: 0.05511139","y: 0.05511139",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.05511139","y: 0.05511139",null,"y: 0.05511139","y: 0.05511139"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.625,2.125,1,3.25,2.5,2,3,4,7.125,6.25,5.5,5,6,7,8],"y":[0.302778065504197,0.0995692696327528,0,0.0551113924680503,0.0329636570421535,0,0,0,0.201403064219327,0.169072159733214,0.0832212592136645,0,0,0,0],"text":["y: 0.30277807","y: 0.09956927","y: 0.00000000","y: 0.05511139","y: 0.03296366","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.20140306","y: 0.16907216","y: 0.08322126","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.813147332477984,0.809769282008035,0.823471530021973,0.575969581159041,0.553728913705336,0.479994203366332,0],[0.813147332477984,1,0.88282200620327,0.889246694946562,0.725441081878836,0.552044776867947,0.377910234870038,0.207964979553019],[0.809769282008035,0.88282200620327,1,0.881382028606287,0.754376829985844,0.605357495559251,0.419061275458016,0.24585292521888],[0.823471530021973,0.889246694946562,0.881382028606287,1,0.832346532944895,0.689116426747772,0.457793000701975,0.394393502086448],[0.575969581159041,0.725441081878836,0.754376829985844,0.832346532944895,1,0.781302405788233,0.549441045338569,0.718104253229025],[0.553728913705336,0.552044776867947,0.605357495559251,0.689116426747772,0.781302405788233,1,0.712685285849945,0.565438135673594],[0.479994203366332,0.377910234870038,0.419061275458016,0.457793000701975,0.549441045338569,0.712685285849945,1,0.386387083028081],[0,0.207964979553019,0.24585292521888,0.394393502086448,0.718104253229025,0.565438135673594,0.386387083028081,1]],"text":[["row: C_CM<br>column: C_CM<br>value: 1.0000","row: C_CM<br>column: H_CF<br>value: 0.9668","row: C_CM<br>column: D_CF<br>value: 0.9662","row: C_CM<br>column: G_CM<br>value: 0.9686","row: C_CM<br>column: B_HM<br>value: 0.9246","row: C_CM<br>column: A_HF<br>value: 0.9206","row: C_CM<br>column: E_HM<br>value: 0.9075","row: C_CM<br>column: F_HF<br>value: 0.8221"],["row: H_CF<br>column: C_CM<br>value: 0.9668","row: H_CF<br>column: H_CF<br>value: 1.0000","row: H_CF<br>column: D_CF<br>value: 0.9792","row: H_CF<br>column: G_CM<br>value: 0.9803","row: H_CF<br>column: B_HM<br>value: 0.9512","row: H_CF<br>column: A_HF<br>value: 0.9203","row: H_CF<br>column: E_HM<br>value: 0.8893","row: H_CF<br>column: F_HF<br>value: 0.8591"],["row: D_CF<br>column: C_CM<br>value: 0.9662","row: D_CF<br>column: H_CF<br>value: 0.9792","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: G_CM<br>value: 0.9789","row: D_CF<br>column: B_HM<br>value: 0.9563","row: D_CF<br>column: A_HF<br>value: 0.9298","row: D_CF<br>column: E_HM<br>value: 0.8967","row: D_CF<br>column: F_HF<br>value: 0.8659"],["row: G_CM<br>column: C_CM<br>value: 0.9686","row: G_CM<br>column: H_CF<br>value: 0.9803","row: G_CM<br>column: D_CF<br>value: 0.9789","row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: B_HM<br>value: 0.9702","row: G_CM<br>column: A_HF<br>value: 0.9447","row: G_CM<br>column: E_HM<br>value: 0.9036","row: G_CM<br>column: F_HF<br>value: 0.8923"],["row: B_HM<br>column: C_CM<br>value: 0.9246","row: B_HM<br>column: H_CF<br>value: 0.9512","row: B_HM<br>column: D_CF<br>value: 0.9563","row: B_HM<br>column: G_CM<br>value: 0.9702","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: A_HF<br>value: 0.9611","row: B_HM<br>column: E_HM<br>value: 0.9199","row: B_HM<br>column: F_HF<br>value: 0.9499"],["row: A_HF<br>column: C_CM<br>value: 0.9206","row: A_HF<br>column: H_CF<br>value: 0.9203","row: A_HF<br>column: D_CF<br>value: 0.9298","row: A_HF<br>column: G_CM<br>value: 0.9447","row: A_HF<br>column: B_HM<br>value: 0.9611","row: A_HF<br>column: A_HF<br>value: 1.0000","row: A_HF<br>column: E_HM<br>value: 0.9489","row: A_HF<br>column: F_HF<br>value: 0.9227"],["row: E_HM<br>column: C_CM<br>value: 0.9075","row: E_HM<br>column: H_CF<br>value: 0.8893","row: E_HM<br>column: D_CF<br>value: 0.8967","row: E_HM<br>column: G_CM<br>value: 0.9036","row: E_HM<br>column: B_HM<br>value: 0.9199","row: E_HM<br>column: A_HF<br>value: 0.9489","row: E_HM<br>column: E_HM<br>value: 1.0000","row: E_HM<br>column: F_HF<br>value: 0.8909"],["row: F_HF<br>column: C_CM<br>value: 0.8221","row: F_HF<br>column: H_CF<br>value: 0.8591","row: F_HF<br>column: D_CF<br>value: 0.8659","row: F_HF<br>column: G_CM<br>value: 0.8923","row: F_HF<br>column: B_HM<br>value: 0.9499","row: F_HF<br>column: A_HF<br>value: 0.9227","row: F_HF<br>column: E_HM<br>value: 0.8909","row: F_HF<br>column: F_HF<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.207964979553019,"#404688"],[0.24585292521888,"#3B518B"],[0.377910234870038,"#2C728E"],[0.386387083028081,"#2B758E"],[0.394393502086448,"#2A778E"],[0.419061275458016,"#287D8E"],[0.457793000701975,"#24868E"],[0.479994203366332,"#228B8D"],[0.549441045338569,"#1E9C89"],[0.552044776867947,"#1E9D89"],[0.553728913705336,"#1E9D89"],[0.565438135673594,"#1FA088"],[0.575969581159041,"#1FA287"],[0.605357495559251,"#23A983"],[0.689116426747772,"#3EBC73"],[0.712685285849945,"#49C16D"],[0.718104253229025,"#4CC26C"],[0.725441081878836,"#50C46A"],[0.754376829985844,"#5FC961"],[0.781302405788233,"#6ECE58"],[0.809769282008035,"#80D34E"],[0.813147332477984,"#82D34C"],[0.823471530021973,"#89D548"],[0.832346532944895,"#8ED645"],[0.881382028606287,"#AFDD2F"],[0.88282200620327,"#B0DD2F"],[0.889246694946562,"#B4DE2B"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_38cab17e6805098ede4b0f7510d24a91","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#471264"],[0.0588235294117648,"#482576"],[0.11764705882353,"#453781"],[0.176470588235294,"#3F4788"],[0.235294117647058,"#38578C"],[0.294117647058823,"#31668E"],[0.352941176470588,"#2C738E"],[0.411764705882353,"#26828E"],[0.470588235294118,"#218F8D"],[0.529411764705882,"#1E9C89"],[0.588235294117647,"#24AA83"],[0.647058823529412,"#34B679"],[0.705882352941176,"#4DC26C"],[0.764705882352941,"#6BCD5A"],[0.823529411764706,"#8ED645"],[0.88235294117647,"#B3DD2C"],[0.941176470588235,"#D9E319"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.85","0.90","0.95","1.00"],"tickvals":[0.11764705882353,0.411764705882353,0.705882352941177,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.302778065504197,0.302778065504197,null,0.302778065504197,0.201403064219327,null,0.201403064219327,0.201403064219327,null,0.201403064219327,0.169072159733214,null,0.169072159733214,0.169072159733214,null,0.169072159733214,0.0832212592136645,null,0.0832212592136645,0.0832212592136645,null,0.0832212592136645,0,null,0.0832212592136645,0.0832212592136645,null,0.0832212592136645,0,null,0.169072159733214,0.169072159733214,null,0.169072159733214,0,null,0.201403064219327,0.201403064219327,null,0.201403064219327,0],"y":[4.625,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"text":["y: 0.30277807","y: 0.30277807",null,"y: 0.30277807","y: 0.30277807",null,"y: 0.20140306","y: 0.20140306",null,"y: 0.20140306","y: 0.20140306",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.08322126","y: 0.08322126",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.16907216","y: 0.16907216",null,"y: 0.20140306","y: 0.20140306",null,"y: 0.20140306","y: 0.20140306"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.302778065504197,0.302778065504197,null,0.302778065504197,0.0995692696327528,null,0.0995692696327528,0.0995692696327528,null,0.0995692696327528,0,null,0.0995692696327528,0.0995692696327528,null,0.0995692696327528,0.0551113924680503,null,0.0551113924680503,0.0551113924680503,null,0.0551113924680503,0.0329636570421535,null,0.0329636570421535,0.0329636570421535,null,0.0329636570421535,0,null,0.0329636570421535,0.0329636570421535,null,0.0329636570421535,0,null,0.0551113924680503,0.0551113924680503,null,0.0551113924680503,0],"y":[4.625,2.125,null,2.125,2.125,null,2.125,1,null,1,1,null,2.125,3.25,null,3.25,3.25,null,3.25,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.25,4,null,4,4],"text":["y: 0.30277807","y: 0.30277807",null,"y: 0.30277807","y: 0.30277807",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.09956927","y: 0.09956927",null,"y: 0.05511139","y: 0.05511139",null,"y: 0.05511139","y: 0.05511139",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.03296366","y: 0.03296366",null,"y: 0.05511139","y: 0.05511139",null,"y: 0.05511139","y: 0.05511139"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.302778065504197,0.0995692696327528,0,0.0551113924680503,0.0329636570421535,0,0,0,0.201403064219327,0.169072159733214,0.0832212592136645,0,0,0,0],"y":[4.625,2.125,1,3.25,2.5,2,3,4,7.125,6.25,5.5,5,6,7,8],"text":["y: 0.30277807","y: 0.09956927","y: 0.00000000","y: 0.05511139","y: 0.03296366","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.20140306","y: 0.16907216","y: 0.08322126","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["C_CM","H_CF","D_CF","G_CM","B_HM","A_HF","E_HM","F_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.302778065504197],"ticktext":["0.0","0.1","0.2","0.3"],"tickvals":[0,0.1,0.2,0.3],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["C_CM","H_CF","D_CF","G_CM","B_HM","A_HF","E_HM","F_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.302778065504197],"ticktext":["0.0","0.1","0.2","0.3"],"tickvals":[0,0.1,0.2,0.3],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Pearson Correlation @ 10kb"},"attrs":{"e21a359fc7de":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21acfadb53":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a4912e6f5":{"alpha":1,"sizes":[10,100]},"e21ad8a46e8":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a6c405102":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a728691d3":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script></p>
<pre class="r"><code>heatmaply(corheats, main=&quot;Pairwise Spearman Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Same as above.</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="e21a525204cd" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21a525204cd">{"x":{"data":[{"x":[4.8125,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"y":[1.02456143988845,1.02456143988845,null,1.02456143988845,0.799361057307632,null,0.799361057307632,0.799361057307632,null,0.799361057307632,0.581631180990519,null,0.581631180990519,0.581631180990519,null,0.581631180990519,0.430162625121193,null,0.430162625121193,0.430162625121193,null,0.430162625121193,0,null,0.430162625121193,0.430162625121193,null,0.430162625121193,0,null,0.581631180990519,0.581631180990519,null,0.581631180990519,0,null,0.799361057307632,0.799361057307632,null,0.799361057307632,0],"text":["y: 1.0245614","y: 1.0245614",null,"y: 1.0245614","y: 1.0245614",null,"y: 0.7993611","y: 0.7993611",null,"y: 0.7993611","y: 0.7993611",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.7993611","y: 0.7993611",null,"y: 0.7993611","y: 0.7993611"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8125,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[1.02456143988845,1.02456143988845,null,1.02456143988845,0.486471927605208,null,0.486471927605208,0.486471927605208,null,0.486471927605208,0.344190979249485,null,0.344190979249485,0.344190979249485,null,0.344190979249485,0,null,0.344190979249485,0.344190979249485,null,0.344190979249485,0,null,0.486471927605208,0.486471927605208,null,0.486471927605208,0.33877113308316,null,0.33877113308316,0.33877113308316,null,0.33877113308316,0,null,0.33877113308316,0.33877113308316,null,0.33877113308316,0],"text":["y: 1.0245614","y: 1.0245614",null,"y: 1.0245614","y: 1.0245614",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.3387711","y: 0.3387711",null,"y: 0.3387711","y: 0.3387711",null,"y: 0.3387711","y: 0.3387711",null,"y: 0.3387711","y: 0.3387711"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8125,2.5,1.5,1,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"y":[1.02456143988845,0.486471927605208,0.344190979249485,0,0,0.33877113308316,0,0,0.799361057307632,0.581631180990519,0.430162625121193,0,0,0,0],"text":["y: 1.0245614","y: 0.4864719","y: 0.3441910","y: 0.0000000","y: 0.0000000","y: 0.3387711","y: 0.0000000","y: 0.0000000","y: 0.7993611","y: 0.5816312","y: 0.4301626","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.627354610893953,0.61269190581194,0.557532664426805,0.336332611943384,0.307673503440037,0.207059273117508,0],[0.627354610893953,1,0.633214119152889,0.595509380312896,0.331436409669729,0.321702641566232,0.211810708956211,0.0822320384411199],[0.61269190581194,0.633214119152889,1,0.643634805368708,0.43545280081443,0.438681587576674,0.330033707377553,0.201888722074779],[0.557532664426805,0.595509380312896,0.643634805368708,1,0.463897306885257,0.493866265603759,0.367244418640406,0.319988804805795],[0.336332611943384,0.331436409669729,0.43545280081443,0.463897306885257,1,0.537153993093362,0.394515814015319,0.319312047409777],[0.307673503440037,0.321702641566232,0.438681587576674,0.493866265603759,0.537153993093362,1,0.47677323176578,0.422303530535789],[0.207059273117508,0.211810708956211,0.330033707377553,0.367244418640406,0.394515814015319,0.47677323176578,1,0.14592633327426],[0,0.0822320384411199,0.201888722074779,0.319988804805795,0.319312047409777,0.422303530535789,0.14592633327426,1]],"text":[["row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: C_CM<br>value: 0.7604","row: G_CM<br>column: H_CF<br>value: 0.7510","row: G_CM<br>column: D_CF<br>value: 0.7155","row: G_CM<br>column: B_HM<br>value: 0.5733","row: G_CM<br>column: F_HF<br>value: 0.5549","row: G_CM<br>column: E_HM<br>value: 0.4902","row: G_CM<br>column: A_HF<br>value: 0.3571"],["row: C_CM<br>column: G_CM<br>value: 0.7604","row: C_CM<br>column: C_CM<br>value: 1.0000","row: C_CM<br>column: H_CF<br>value: 0.7642","row: C_CM<br>column: D_CF<br>value: 0.7399","row: C_CM<br>column: B_HM<br>value: 0.5702","row: C_CM<br>column: F_HF<br>value: 0.5639","row: C_CM<br>column: E_HM<br>value: 0.4933","row: C_CM<br>column: A_HF<br>value: 0.4099"],["row: H_CF<br>column: G_CM<br>value: 0.7510","row: H_CF<br>column: C_CM<br>value: 0.7642","row: H_CF<br>column: H_CF<br>value: 1.0000","row: H_CF<br>column: D_CF<br>value: 0.7709","row: H_CF<br>column: B_HM<br>value: 0.6370","row: H_CF<br>column: F_HF<br>value: 0.6391","row: H_CF<br>column: E_HM<br>value: 0.5693","row: H_CF<br>column: A_HF<br>value: 0.4869"],["row: D_CF<br>column: G_CM<br>value: 0.7155","row: D_CF<br>column: C_CM<br>value: 0.7399","row: D_CF<br>column: H_CF<br>value: 0.7709","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: B_HM<br>value: 0.6553","row: D_CF<br>column: F_HF<br>value: 0.6746","row: D_CF<br>column: E_HM<br>value: 0.5932","row: D_CF<br>column: A_HF<br>value: 0.5628"],["row: B_HM<br>column: G_CM<br>value: 0.5733","row: B_HM<br>column: C_CM<br>value: 0.5702","row: B_HM<br>column: H_CF<br>value: 0.6370","row: B_HM<br>column: D_CF<br>value: 0.6553","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: F_HF<br>value: 0.7024","row: B_HM<br>column: E_HM<br>value: 0.6107","row: B_HM<br>column: A_HF<br>value: 0.5624"],["row: F_HF<br>column: G_CM<br>value: 0.5549","row: F_HF<br>column: C_CM<br>value: 0.5639","row: F_HF<br>column: H_CF<br>value: 0.6391","row: F_HF<br>column: D_CF<br>value: 0.6746","row: F_HF<br>column: B_HM<br>value: 0.7024","row: F_HF<br>column: F_HF<br>value: 1.0000","row: F_HF<br>column: E_HM<br>value: 0.6636","row: F_HF<br>column: A_HF<br>value: 0.6286"],["row: E_HM<br>column: G_CM<br>value: 0.4902","row: E_HM<br>column: C_CM<br>value: 0.4933","row: E_HM<br>column: H_CF<br>value: 0.5693","row: E_HM<br>column: D_CF<br>value: 0.5932","row: E_HM<br>column: B_HM<br>value: 0.6107","row: E_HM<br>column: F_HF<br>value: 0.6636","row: E_HM<br>column: E_HM<br>value: 1.0000","row: E_HM<br>column: A_HF<br>value: 0.4509"],["row: A_HF<br>column: G_CM<br>value: 0.3571","row: A_HF<br>column: C_CM<br>value: 0.4099","row: A_HF<br>column: H_CF<br>value: 0.4869","row: A_HF<br>column: D_CF<br>value: 0.5628","row: A_HF<br>column: B_HM<br>value: 0.5624","row: A_HF<br>column: F_HF<br>value: 0.6286","row: A_HF<br>column: E_HM<br>value: 0.4509","row: A_HF<br>column: A_HF<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.0822320384411199,"#481F70"],[0.14592633327426,"#46337F"],[0.201888722074779,"#414487"],[0.207059273117508,"#404688"],[0.211810708956211,"#3F4788"],[0.307673503440037,"#34618D"],[0.319312047409777,"#32648E"],[0.319988804805795,"#32658E"],[0.321702641566232,"#32658E"],[0.330033707377553,"#31678E"],[0.331436409669729,"#31688E"],[0.336332611943384,"#30698E"],[0.367244418640406,"#2D718E"],[0.394515814015319,"#2A778E"],[0.422303530535789,"#277E8E"],[0.43545280081443,"#26818E"],[0.438681587576674,"#26828E"],[0.463897306885257,"#24878E"],[0.47677323176578,"#228B8D"],[0.493866265603759,"#218F8D"],[0.537153993093362,"#1F998A"],[0.557532664426805,"#1F9E89"],[0.595509380312896,"#22A785"],[0.61269190581194,"#25AB82"],[0.627354610893953,"#28AE80"],[0.633214119152889,"#29AF7F"],[0.643634805368708,"#2DB27D"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_3817e37ff849a9c4add2440ed6da177e","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#481A6C"],[0.0833333333333333,"#46337F"],[0.166666666666667,"#3E4A89"],[0.25,"#34608D"],[0.333333333333333,"#2C728E"],[0.416666666666667,"#25858E"],[0.5,"#1F988B"],[0.583333333333333,"#25AB82"],[0.666666666666667,"#3EBC73"],[0.75,"#66CC5D"],[0.833333333333333,"#96D83F"],[0.916666666666667,"#CBE11F"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.4","0.6","0.8","1.0"],"tickvals":[0,0.333333333333333,0.666666666666667,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1.02456143988845,1.02456143988845,null,1.02456143988845,0.799361057307632,null,0.799361057307632,0.799361057307632,null,0.799361057307632,0.581631180990519,null,0.581631180990519,0.581631180990519,null,0.581631180990519,0.430162625121193,null,0.430162625121193,0.430162625121193,null,0.430162625121193,0,null,0.430162625121193,0.430162625121193,null,0.430162625121193,0,null,0.581631180990519,0.581631180990519,null,0.581631180990519,0,null,0.799361057307632,0.799361057307632,null,0.799361057307632,0],"y":[4.8125,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"text":["y: 1.0245614","y: 1.0245614",null,"y: 1.0245614","y: 1.0245614",null,"y: 0.7993611","y: 0.7993611",null,"y: 0.7993611","y: 0.7993611",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.4301626","y: 0.4301626",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.5816312","y: 0.5816312",null,"y: 0.7993611","y: 0.7993611",null,"y: 0.7993611","y: 0.7993611"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1.02456143988845,1.02456143988845,null,1.02456143988845,0.486471927605208,null,0.486471927605208,0.486471927605208,null,0.486471927605208,0.344190979249485,null,0.344190979249485,0.344190979249485,null,0.344190979249485,0,null,0.344190979249485,0.344190979249485,null,0.344190979249485,0,null,0.486471927605208,0.486471927605208,null,0.486471927605208,0.33877113308316,null,0.33877113308316,0.33877113308316,null,0.33877113308316,0,null,0.33877113308316,0.33877113308316,null,0.33877113308316,0],"y":[4.8125,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"text":["y: 1.0245614","y: 1.0245614",null,"y: 1.0245614","y: 1.0245614",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.3441910","y: 0.3441910",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.4864719","y: 0.4864719",null,"y: 0.3387711","y: 0.3387711",null,"y: 0.3387711","y: 0.3387711",null,"y: 0.3387711","y: 0.3387711",null,"y: 0.3387711","y: 0.3387711"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1.02456143988845,0.486471927605208,0.344190979249485,0,0,0.33877113308316,0,0,0.799361057307632,0.581631180990519,0.430162625121193,0,0,0,0],"y":[4.8125,2.5,1.5,1,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"text":["y: 1.0245614","y: 0.4864719","y: 0.3441910","y: 0.0000000","y: 0.0000000","y: 0.3387711","y: 0.0000000","y: 0.0000000","y: 0.7993611","y: 0.5816312","y: 0.4301626","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["G_CM","C_CM","H_CF","D_CF","B_HM","F_HF","E_HM","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,1.02456143988845],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["G_CM","C_CM","H_CF","D_CF","B_HM","F_HF","E_HM","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,1.02456143988845],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Spearman Correlation @ 10kb"},"attrs":{"e21a26d80ea8":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a32aa4b84":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a2f0b677f":{"alpha":1,"sizes":[10,100]},"e21a766ebc3e":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a79257b4f":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21abc2bdac":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>#Can&#39;t manage to find a cyclic loess normalization here that makes samples cluster properly for both types of correlations...can get samples clustering in appropriate places but not get the dendrogram to look how I expect--just use same settings as above, in interest of consistency.
full.contacts.KR &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=0.36, iterations=3, method=&quot;pairs&quot;)) #Method=&quot;fast&quot; doesn&#39;t give us the same awesomeness here, but that&#39;s not too surprising considering different normalization schemes. .26 and .32 may also be worth checking here.

#KR Correlations
corheat &lt;- cor(full.contacts.KR, use=&quot;complete.obs&quot;, method=&quot;pearson&quot;) #Corheat for the full data set, and heatmap. Pearson clusters poorly.
corheats &lt;- cor(full.contacts.KR, use=&quot;complete.obs&quot;, method=&quot;spearman&quot;)
colnames(corheat) &lt;- c(&quot;A_HF&quot;, &quot;B_HM&quot;, &quot;C_CM&quot;, &quot;D_CF&quot;, &quot;E_HM&quot;, &quot;F_HF&quot;, &quot;G_CM&quot;, &quot;H_CF&quot;)
rownames(corheat) &lt;- colnames(corheat)
colnames(corheats) &lt;- colnames(corheat)
rownames(corheats) &lt;- colnames(corheat)

#KR Clustering
heatmaply(corheat, main=&quot;Pairwise Pearson Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Clusters poorly, but at least species groups are maintained!</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="e21ae0cd385" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21ae0cd385">{"x":{"data":[{"x":[4.375,6.875,null,6.875,6.875,null,6.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,6.875,8,null,8,8],"y":[0.130235096301917,0.130235096301917,null,0.130235096301917,0.0773575498947096,null,0.0773575498947096,0.0773575498947096,null,0.0773575498947096,0.0601278162945311,null,0.0601278162945311,0.0601278162945311,null,0.0601278162945311,0,null,0.0601278162945311,0.0601278162945311,null,0.0601278162945311,0.0420635197519854,null,0.0420635197519854,0.0420635197519854,null,0.0420635197519854,0,null,0.0420635197519854,0.0420635197519854,null,0.0420635197519854,0,null,0.0773575498947096,0.0773575498947096,null,0.0773575498947096,0],"text":["y: 0.13023510","y: 0.13023510",null,"y: 0.13023510","y: 0.13023510",null,"y: 0.07735755","y: 0.07735755",null,"y: 0.07735755","y: 0.07735755",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.07735755","y: 0.07735755",null,"y: 0.07735755","y: 0.07735755"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.375,1.875,null,1.875,1.875,null,1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[0.130235096301917,0.130235096301917,null,0.130235096301917,0.0610660666103926,null,0.0610660666103926,0.0610660666103926,null,0.0610660666103926,0,null,0.0610660666103926,0.0610660666103926,null,0.0610660666103926,0.0250164815494773,null,0.0250164815494773,0.0250164815494773,null,0.0250164815494773,0,null,0.0250164815494773,0.0250164815494773,null,0.0250164815494773,0.0189785695024437,null,0.0189785695024437,0.0189785695024437,null,0.0189785695024437,0,null,0.0189785695024437,0.0189785695024437,null,0.0189785695024437,0],"text":["y: 0.13023510","y: 0.13023510",null,"y: 0.13023510","y: 0.13023510",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.01897857","y: 0.01897857",null,"y: 0.01897857","y: 0.01897857",null,"y: 0.01897857","y: 0.01897857",null,"y: 0.01897857","y: 0.01897857"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.375,1.875,1,2.75,2,3.5,3,4,6.875,5.75,5,6.5,6,7,8],"y":[0.130235096301917,0.0610660666103926,0,0.0250164815494773,0,0.0189785695024437,0,0,0.0773575498947096,0.0601278162945311,0,0.0420635197519854,0,0,0],"text":["y: 0.13023510","y: 0.06106607","y: 0.00000000","y: 0.02501648","y: 0.00000000","y: 0.01897857","y: 0.00000000","y: 0.00000000","y: 0.07735755","y: 0.06012782","y: 0.00000000","y: 0.04206352","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.825639647152297,0.833568484131531,0.717241376056382,0.439008613563937,0.544390944348445,0.36883003906552,0],[0.825639647152297,1,0.858892447954221,0.846209795211083,0.557994681930626,0.720645841900128,0.634599673980701,0.373360342849758],[0.833568484131531,0.858892447954221,1,0.891818701838143,0.653981824332271,0.658057769991988,0.607985498533679,0.406530748768955],[0.717241376056382,0.846209795211083,0.891818701838143,1,0.629366677133637,0.637038400232538,0.664802889653526,0.523630313418678],[0.439008613563937,0.557994681930626,0.653981824332271,0.629366677133637,1,0.507789844903594,0.524551111619065,0.584657567396524],[0.544390944348445,0.720645841900128,0.658057769991988,0.637038400232538,0.507789844903594,1,0.695553797313853,0.545689030959612],[0.36883003906552,0.634599673980701,0.607985498533679,0.664802889653526,0.524551111619065,0.695553797313853,1,0.754126627963256],[0,0.373360342849758,0.406530748768955,0.523630313418678,0.584657567396524,0.545689030959612,0.754126627963256,1]],"text":[["row: H_CF<br>column: H_CF<br>value: 1.0000","row: H_CF<br>column: D_CF<br>value: 0.9859","row: H_CF<br>column: G_CM<br>value: 0.9865","row: H_CF<br>column: C_CM<br>value: 0.9771","row: H_CF<br>column: F_HF<br>value: 0.9546","row: H_CF<br>column: A_HF<br>value: 0.9632","row: H_CF<br>column: B_HM<br>value: 0.9490","row: H_CF<br>column: E_HM<br>value: 0.9191"],["row: D_CF<br>column: H_CF<br>value: 0.9859","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: G_CM<br>value: 0.9886","row: D_CF<br>column: C_CM<br>value: 0.9876","row: D_CF<br>column: F_HF<br>value: 0.9643","row: D_CF<br>column: A_HF<br>value: 0.9774","row: D_CF<br>column: B_HM<br>value: 0.9705","row: D_CF<br>column: E_HM<br>value: 0.9493"],["row: G_CM<br>column: H_CF<br>value: 0.9865","row: G_CM<br>column: D_CF<br>value: 0.9886","row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: C_CM<br>value: 0.9913","row: G_CM<br>column: F_HF<br>value: 0.9720","row: G_CM<br>column: A_HF<br>value: 0.9724","row: G_CM<br>column: B_HM<br>value: 0.9683","row: G_CM<br>column: E_HM<br>value: 0.9520"],["row: C_CM<br>column: H_CF<br>value: 0.9771","row: C_CM<br>column: D_CF<br>value: 0.9876","row: C_CM<br>column: G_CM<br>value: 0.9913","row: C_CM<br>column: C_CM<br>value: 1.0000","row: C_CM<br>column: F_HF<br>value: 0.9700","row: C_CM<br>column: A_HF<br>value: 0.9707","row: C_CM<br>column: B_HM<br>value: 0.9729","row: C_CM<br>column: E_HM<br>value: 0.9615"],["row: F_HF<br>column: H_CF<br>value: 0.9546","row: F_HF<br>column: D_CF<br>value: 0.9643","row: F_HF<br>column: G_CM<br>value: 0.9720","row: F_HF<br>column: C_CM<br>value: 0.9700","row: F_HF<br>column: F_HF<br>value: 1.0000","row: F_HF<br>column: A_HF<br>value: 0.9602","row: F_HF<br>column: B_HM<br>value: 0.9616","row: F_HF<br>column: E_HM<br>value: 0.9664"],["row: A_HF<br>column: H_CF<br>value: 0.9632","row: A_HF<br>column: D_CF<br>value: 0.9774","row: A_HF<br>column: G_CM<br>value: 0.9724","row: A_HF<br>column: C_CM<br>value: 0.9707","row: A_HF<br>column: F_HF<br>value: 0.9602","row: A_HF<br>column: A_HF<br>value: 1.0000","row: A_HF<br>column: B_HM<br>value: 0.9754","row: A_HF<br>column: E_HM<br>value: 0.9633"],["row: B_HM<br>column: H_CF<br>value: 0.9490","row: B_HM<br>column: D_CF<br>value: 0.9705","row: B_HM<br>column: G_CM<br>value: 0.9683","row: B_HM<br>column: C_CM<br>value: 0.9729","row: B_HM<br>column: F_HF<br>value: 0.9616","row: B_HM<br>column: A_HF<br>value: 0.9754","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: E_HM<br>value: 0.9801"],["row: E_HM<br>column: H_CF<br>value: 0.9191","row: E_HM<br>column: D_CF<br>value: 0.9493","row: E_HM<br>column: G_CM<br>value: 0.9520","row: E_HM<br>column: C_CM<br>value: 0.9615","row: E_HM<br>column: F_HF<br>value: 0.9664","row: E_HM<br>column: A_HF<br>value: 0.9633","row: E_HM<br>column: B_HM<br>value: 0.9801","row: E_HM<br>column: E_HM<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.36883003906552,"#2D718E"],[0.373360342849758,"#2C718E"],[0.406530748768955,"#297A8E"],[0.439008613563937,"#26828E"],[0.507789844903594,"#20928C"],[0.523630313418678,"#1F968B"],[0.524551111619065,"#1F968B"],[0.544390944348445,"#1E9B8A"],[0.545689030959612,"#1E9B8A"],[0.557994681930626,"#1F9E89"],[0.584657567396524,"#20A486"],[0.607985498533679,"#24AA83"],[0.629366677133637,"#28AE80"],[0.634599673980701,"#2AB07F"],[0.637038400232538,"#2BB07F"],[0.653981824332271,"#31B57B"],[0.658057769991988,"#32B67A"],[0.664802889653526,"#35B779"],[0.695553797313853,"#41BD72"],[0.717241376056382,"#4CC26C"],[0.720645841900128,"#4EC36B"],[0.754126627963256,"#5FC961"],[0.825639647152297,"#8AD647"],[0.833568484131531,"#8FD744"],[0.846209795211083,"#97D83E"],[0.858892447954221,"#A0DA39"],[0.891818701838143,"#B6DE2A"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_2fe06146b449ccd58509c80f64a2ada0","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#450558"],[0.0625000000000001,"#481B6D"],[0.125,"#472F7D"],[0.1875,"#414287"],[0.25,"#3A548C"],[0.3125,"#32658E"],[0.375,"#2C738E"],[0.437500000000001,"#26828E"],[0.499999999999999,"#20928C"],[0.562499999999999,"#1FA188"],[0.624999999999999,"#28AE80"],[0.6875,"#3FBC73"],[0.75,"#5EC962"],[0.8125,"#83D44C"],[0.875,"#ABDC31"],[0.9375,"#D6E21A"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.92","0.94","0.96","0.98","1.00"],"tickvals":[0,0.25,0.500000000000001,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.130235096301917,0.130235096301917,null,0.130235096301917,0.0773575498947096,null,0.0773575498947096,0.0773575498947096,null,0.0773575498947096,0.0601278162945311,null,0.0601278162945311,0.0601278162945311,null,0.0601278162945311,0,null,0.0601278162945311,0.0601278162945311,null,0.0601278162945311,0.0420635197519854,null,0.0420635197519854,0.0420635197519854,null,0.0420635197519854,0,null,0.0420635197519854,0.0420635197519854,null,0.0420635197519854,0,null,0.0773575498947096,0.0773575498947096,null,0.0773575498947096,0],"y":[4.375,6.875,null,6.875,6.875,null,6.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,6.875,8,null,8,8],"text":["y: 0.13023510","y: 0.13023510",null,"y: 0.13023510","y: 0.13023510",null,"y: 0.07735755","y: 0.07735755",null,"y: 0.07735755","y: 0.07735755",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.06012782","y: 0.06012782",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.04206352","y: 0.04206352",null,"y: 0.07735755","y: 0.07735755",null,"y: 0.07735755","y: 0.07735755"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.130235096301917,0.130235096301917,null,0.130235096301917,0.0610660666103926,null,0.0610660666103926,0.0610660666103926,null,0.0610660666103926,0,null,0.0610660666103926,0.0610660666103926,null,0.0610660666103926,0.0250164815494773,null,0.0250164815494773,0.0250164815494773,null,0.0250164815494773,0,null,0.0250164815494773,0.0250164815494773,null,0.0250164815494773,0.0189785695024437,null,0.0189785695024437,0.0189785695024437,null,0.0189785695024437,0,null,0.0189785695024437,0.0189785695024437,null,0.0189785695024437,0],"y":[4.375,1.875,null,1.875,1.875,null,1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"text":["y: 0.13023510","y: 0.13023510",null,"y: 0.13023510","y: 0.13023510",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.06106607","y: 0.06106607",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.02501648","y: 0.02501648",null,"y: 0.01897857","y: 0.01897857",null,"y: 0.01897857","y: 0.01897857",null,"y: 0.01897857","y: 0.01897857",null,"y: 0.01897857","y: 0.01897857"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.130235096301917,0.0610660666103926,0,0.0250164815494773,0,0.0189785695024437,0,0,0.0773575498947096,0.0601278162945311,0,0.0420635197519854,0,0,0],"y":[4.375,1.875,1,2.75,2,3.5,3,4,6.875,5.75,5,6.5,6,7,8],"text":["y: 0.13023510","y: 0.06106607","y: 0.00000000","y: 0.02501648","y: 0.00000000","y: 0.01897857","y: 0.00000000","y: 0.00000000","y: 0.07735755","y: 0.06012782","y: 0.00000000","y: 0.04206352","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["H_CF","D_CF","G_CM","C_CM","F_HF","A_HF","B_HM","E_HM"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.130235096301917],"ticktext":["0.000","0.025","0.050","0.075","0.100","0.125"],"tickvals":[0,0.025,0.05,0.075,0.1,0.125],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["H_CF","D_CF","G_CM","C_CM","F_HF","A_HF","B_HM","E_HM"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.130235096301917],"ticktext":["0.000","0.025","0.050","0.075","0.100","0.125"],"tickvals":[0,0.025,0.05,0.075,0.1,0.125],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Pearson Correlation @ 10kb"},"attrs":{"e21a13d82ebe":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a55e4c61f":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a12221c86":{"alpha":1,"sizes":[10,100]},"e21a7a2d8711":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a3edb65fb":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a360461fa":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>heatmaply(corheats, main=&quot;Pairwise Spearman Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Clusters excellently!</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="e21a43a733a1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21a43a733a1">{"x":{"data":[{"x":[4.8125,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"y":[0.55356833550232,0.55356833550232,null,0.55356833550232,0.328135374690992,null,0.328135374690992,0.328135374690992,null,0.328135374690992,0.275863482357505,null,0.275863482357505,0.275863482357505,null,0.275863482357505,0.174564207100027,null,0.174564207100027,0.174564207100027,null,0.174564207100027,0,null,0.174564207100027,0.174564207100027,null,0.174564207100027,0,null,0.275863482357505,0.275863482357505,null,0.275863482357505,0,null,0.328135374690992,0.328135374690992,null,0.328135374690992,0],"text":["y: 0.5535683","y: 0.5535683",null,"y: 0.5535683","y: 0.5535683",null,"y: 0.3281354","y: 0.3281354",null,"y: 0.3281354","y: 0.3281354",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.3281354","y: 0.3281354",null,"y: 0.3281354","y: 0.3281354"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8125,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[0.55356833550232,0.55356833550232,null,0.55356833550232,0.22706750235173,null,0.22706750235173,0.22706750235173,null,0.22706750235173,0.18887626373942,null,0.18887626373942,0.18887626373942,null,0.18887626373942,0,null,0.18887626373942,0.18887626373942,null,0.18887626373942,0,null,0.22706750235173,0.22706750235173,null,0.22706750235173,0.194980125605588,null,0.194980125605588,0.194980125605588,null,0.194980125605588,0,null,0.194980125605588,0.194980125605588,null,0.194980125605588,0],"text":["y: 0.5535683","y: 0.5535683",null,"y: 0.5535683","y: 0.5535683",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.1949801","y: 0.1949801",null,"y: 0.1949801","y: 0.1949801",null,"y: 0.1949801","y: 0.1949801",null,"y: 0.1949801","y: 0.1949801"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8125,2.5,1.5,1,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"y":[0.55356833550232,0.22706750235173,0.18887626373942,0,0,0.194980125605588,0,0,0.328135374690992,0.275863482357505,0.174564207100027,0,0,0,0],"text":["y: 0.5535683","y: 0.2270675","y: 0.1888763","y: 0.0000000","y: 0.0000000","y: 0.1949801","y: 0.0000000","y: 0.0000000","y: 0.3281354","y: 0.2758635","y: 0.1745642","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.600981726901523,0.56059854706997,0.563287253023776,0.361815395917693,0.307117221290118,0.13971134143822,0],[0.600981726901523,1,0.579522008240757,0.56041744758277,0.357424245213633,0.306654213851922,0.139741821598112,0.0281623913802208],[0.56059854706997,0.579522008240757,1,0.590674598028105,0.431162062258212,0.395512851797806,0.232950034046808,0.149419947892606],[0.563287253023776,0.56041744758277,0.590674598028105,1,0.463840761109991,0.431399875650161,0.252710137775826,0.198291101136526],[0.361815395917693,0.357424245213633,0.431162062258212,0.463840761109991,1,0.636986225964832,0.511662309612253,0.478723414809757],[0.307117221290118,0.306654213851922,0.395512851797806,0.431399875650161,0.636986225964832,1,0.51778401508092,0.517713785021158],[0.13971134143822,0.139741821598112,0.232950034046808,0.252710137775826,0.511662309612253,0.51778401508092,1,0.378428792140177],[0,0.0281623913802208,0.149419947892606,0.198291101136526,0.478723414809757,0.517713785021158,0.378428792140177,1]],"text":[["row: C_CM<br>column: C_CM<br>value: 1.0000","row: C_CM<br>column: G_CM<br>value: 0.8667","row: C_CM<br>column: H_CF<br>value: 0.8532","row: C_CM<br>column: D_CF<br>value: 0.8541","row: C_CM<br>column: F_HF<br>value: 0.7868","row: C_CM<br>column: B_HM<br>value: 0.7685","row: C_CM<br>column: E_HM<br>value: 0.7126","row: C_CM<br>column: A_HF<br>value: 0.6659"],["row: G_CM<br>column: C_CM<br>value: 0.8667","row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: H_CF<br>value: 0.8595","row: G_CM<br>column: D_CF<br>value: 0.8531","row: G_CM<br>column: F_HF<br>value: 0.7853","row: G_CM<br>column: B_HM<br>value: 0.7684","row: G_CM<br>column: E_HM<br>value: 0.7126","row: G_CM<br>column: A_HF<br>value: 0.6753"],["row: H_CF<br>column: C_CM<br>value: 0.8532","row: H_CF<br>column: G_CM<br>value: 0.8595","row: H_CF<br>column: H_CF<br>value: 1.0000","row: H_CF<br>column: D_CF<br>value: 0.8632","row: H_CF<br>column: F_HF<br>value: 0.8100","row: H_CF<br>column: B_HM<br>value: 0.7980","row: H_CF<br>column: E_HM<br>value: 0.7437","row: H_CF<br>column: A_HF<br>value: 0.7158"],["row: D_CF<br>column: C_CM<br>value: 0.8541","row: D_CF<br>column: G_CM<br>value: 0.8531","row: D_CF<br>column: H_CF<br>value: 0.8632","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: F_HF<br>value: 0.8209","row: D_CF<br>column: B_HM<br>value: 0.8100","row: D_CF<br>column: E_HM<br>value: 0.7503","row: D_CF<br>column: A_HF<br>value: 0.7322"],["row: F_HF<br>column: C_CM<br>value: 0.7868","row: F_HF<br>column: G_CM<br>value: 0.7853","row: F_HF<br>column: H_CF<br>value: 0.8100","row: F_HF<br>column: D_CF<br>value: 0.8209","row: F_HF<br>column: F_HF<br>value: 1.0000","row: F_HF<br>column: B_HM<br>value: 0.8787","row: F_HF<br>column: E_HM<br>value: 0.8368","row: F_HF<br>column: A_HF<br>value: 0.8258"],["row: B_HM<br>column: C_CM<br>value: 0.7685","row: B_HM<br>column: G_CM<br>value: 0.7684","row: B_HM<br>column: H_CF<br>value: 0.7980","row: B_HM<br>column: D_CF<br>value: 0.8100","row: B_HM<br>column: F_HF<br>value: 0.8787","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: E_HM<br>value: 0.8389","row: B_HM<br>column: A_HF<br>value: 0.8389"],["row: E_HM<br>column: C_CM<br>value: 0.7126","row: E_HM<br>column: G_CM<br>value: 0.7126","row: E_HM<br>column: H_CF<br>value: 0.7437","row: E_HM<br>column: D_CF<br>value: 0.7503","row: E_HM<br>column: F_HF<br>value: 0.8368","row: E_HM<br>column: B_HM<br>value: 0.8389","row: E_HM<br>column: E_HM<br>value: 1.0000","row: E_HM<br>column: A_HF<br>value: 0.7923"],["row: A_HF<br>column: C_CM<br>value: 0.6659","row: A_HF<br>column: G_CM<br>value: 0.6753","row: A_HF<br>column: H_CF<br>value: 0.7158","row: A_HF<br>column: D_CF<br>value: 0.7322","row: A_HF<br>column: F_HF<br>value: 0.8258","row: A_HF<br>column: B_HM<br>value: 0.8389","row: A_HF<br>column: E_HM<br>value: 0.7923","row: A_HF<br>column: A_HF<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.0281623913802208,"#460B5E"],[0.13971134143822,"#46317E"],[0.139741821598112,"#46317E"],[0.149419947892606,"#463480"],[0.198291101136526,"#414387"],[0.232950034046808,"#3D4D8A"],[0.252710137775826,"#3B528B"],[0.306654213851922,"#34618D"],[0.307117221290118,"#34618D"],[0.357424245213633,"#2E6E8E"],[0.361815395917693,"#2E6F8E"],[0.378428792140177,"#2C728E"],[0.395512851797806,"#2A778E"],[0.431162062258212,"#27808E"],[0.431399875650161,"#27808E"],[0.463840761109991,"#24878E"],[0.478723414809757,"#228B8D"],[0.511662309612253,"#20928C"],[0.517713785021158,"#1F948C"],[0.51778401508092,"#1F948C"],[0.56041744758277,"#1F9F88"],[0.56059854706997,"#1F9F88"],[0.563287253023776,"#1FA088"],[0.579522008240757,"#20A386"],[0.590674598028105,"#21A685"],[0.600981726901523,"#22A884"],[0.636986225964832,"#2BB07F"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_166bae4a4a57a5bc2f67f5c223e66f44","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#471164"],[0.0625000000000001,"#482576"],[0.125,"#453882"],[0.1875,"#3E4A89"],[0.25,"#375B8D"],[0.3125,"#306A8E"],[0.375,"#2A788E"],[0.4375,"#24878E"],[0.5,"#1F958B"],[0.5625,"#20A386"],[0.625,"#2CB17E"],[0.6875,"#43BF70"],[0.75,"#63CB5F"],[0.8125,"#87D549"],[0.875,"#AEDC30"],[0.9375,"#D7E219"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.7","0.8","0.9","1.0"],"tickvals":[0.0625000000000001,0.375,0.6875,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.55356833550232,0.55356833550232,null,0.55356833550232,0.328135374690992,null,0.328135374690992,0.328135374690992,null,0.328135374690992,0.275863482357505,null,0.275863482357505,0.275863482357505,null,0.275863482357505,0.174564207100027,null,0.174564207100027,0.174564207100027,null,0.174564207100027,0,null,0.174564207100027,0.174564207100027,null,0.174564207100027,0,null,0.275863482357505,0.275863482357505,null,0.275863482357505,0,null,0.328135374690992,0.328135374690992,null,0.328135374690992,0],"y":[4.8125,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"text":["y: 0.5535683","y: 0.5535683",null,"y: 0.5535683","y: 0.5535683",null,"y: 0.3281354","y: 0.3281354",null,"y: 0.3281354","y: 0.3281354",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.1745642","y: 0.1745642",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.2758635","y: 0.2758635",null,"y: 0.3281354","y: 0.3281354",null,"y: 0.3281354","y: 0.3281354"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.55356833550232,0.55356833550232,null,0.55356833550232,0.22706750235173,null,0.22706750235173,0.22706750235173,null,0.22706750235173,0.18887626373942,null,0.18887626373942,0.18887626373942,null,0.18887626373942,0,null,0.18887626373942,0.18887626373942,null,0.18887626373942,0,null,0.22706750235173,0.22706750235173,null,0.22706750235173,0.194980125605588,null,0.194980125605588,0.194980125605588,null,0.194980125605588,0,null,0.194980125605588,0.194980125605588,null,0.194980125605588,0],"y":[4.8125,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"text":["y: 0.5535683","y: 0.5535683",null,"y: 0.5535683","y: 0.5535683",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.1888763","y: 0.1888763",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.2270675","y: 0.2270675",null,"y: 0.1949801","y: 0.1949801",null,"y: 0.1949801","y: 0.1949801",null,"y: 0.1949801","y: 0.1949801",null,"y: 0.1949801","y: 0.1949801"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.55356833550232,0.22706750235173,0.18887626373942,0,0,0.194980125605588,0,0,0.328135374690992,0.275863482357505,0.174564207100027,0,0,0,0],"y":[4.8125,2.5,1.5,1,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"text":["y: 0.5535683","y: 0.2270675","y: 0.1888763","y: 0.0000000","y: 0.0000000","y: 0.1949801","y: 0.0000000","y: 0.0000000","y: 0.3281354","y: 0.2758635","y: 0.1745642","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["C_CM","G_CM","H_CF","D_CF","F_HF","B_HM","E_HM","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.55356833550232],"ticktext":["0.0","0.1","0.2","0.3","0.4","0.5"],"tickvals":[0,0.1,0.2,0.3,0.4,0.5],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["C_CM","G_CM","H_CF","D_CF","F_HF","B_HM","E_HM","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.55356833550232],"ticktext":["0.0","0.1","0.2","0.3","0.4","0.5"],"tickvals":[0,0.1,0.2,0.3,0.4,0.5],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Spearman Correlation @ 10kb"},"attrs":{"e21a30dddbfb":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a359554cd":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a49fdfa50":{"alpha":1,"sizes":[10,100]},"e21a25a8c1f6":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a6fb1676":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a4e7fa08e":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>#FINALLY have something that works for both, and boxplots look good. One last check on them before moving to hists of dist&#39;ns:
boxplot(full.contacts.KR, ylim=c(0, 30), horizontal = TRUE, main=&quot;KR Distributions, Normalized&quot;)</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>boxplot(full.contacts.VC, ylim=c(0, 30), horizontal=TRUE, main=&quot;VC Distributions, Normalized&quot;)</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###First, a quick look at histograms of the distributions of the significant Hi-C hits from homer, in both humans and chimps. Create the melted dfs for each first otherwise it takes an absurd amount of time/memory:
VC.humans &lt;- melt(full.contacts.VC[,c(1:2, 5:6)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>VC.chimps &lt;- melt(full.contacts.VC[,c(3:4, 7:8)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>KR.humans &lt;- melt(full.contacts.KR[,c(1:2, 5:6)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>KR.chimps &lt;- melt(full.contacts.KR[,c(3:4, 7:8)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>#VC-normalized distributions:
ggplot(data=VC.humans, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Normalized Juicer Hi-C Contacts, Humans&quot;) + xlab(&quot;Juicer VC-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 3500)) #Human dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-9.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=VC.chimps, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Normalized Juicer Hi-C Contacts, Chimps&quot;) + xlab(&quot;Juicer VC-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 3500)) #Chimp Dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Both sets of distributions look fairly bimodal, with chimps in particular showing a peak around 0.

###Now, the same thing for the KR-normalized interaction frequencies:
ggplot(data=KR.humans, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Normalized Juicer Hi-C Contacts, Humans&quot;) + xlab(&quot;Juicer KR-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 1500)) #Human dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-11.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=KR.chimps, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Normalized Juicer Hi-C Contacts, Chimps&quot;) + xlab(&quot;Juicer KR-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 1500)) #Chimp Dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###########Take a look at these again, but on the raw data before normalization between samples:
VC.humans &lt;- melt(VC.contacts[,c(1:2, 5:6)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>VC.chimps &lt;- melt(VC.contacts[,c(3:4, 7:8)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>KR.humans &lt;- melt(KR.contacts[,c(1:2, 5:6)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>KR.chimps &lt;- melt(KR.contacts[,c(3:4, 7:8)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>#VC-normalized distributions:
ggplot(data=VC.humans, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Humans&quot;) + xlab(&quot;Juicer VC-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 3500)) #Human dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-13.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=VC.chimps, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Chimps&quot;) + xlab(&quot;Juicer VC-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 3500)) #Chimp Dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-14.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Both sets of distributions look fairly bimodal, with chimps in particular showing a peak around 0.

###Now, the same thing for the KR-normalized interaction frequencies:
ggplot(data=KR.humans, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Humans&quot;) + xlab(&quot;Juicer KR-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 1500)) #Human dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-15.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=KR.chimps, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Chimps&quot;) + xlab(&quot;Juicer KR-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 1500)) #Chimp Dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-16.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#There is no longer a good case for not normalizing in a pairwise cyclic loess fashion, especially now that I have clustering working on both types of normalization--just use what we have from here on out.

######PiCKUP HERE and see if I then slotted these pairwise cyclic loess back into the full DF in the other paradigm. I did indeed slot things into the data frame again in the other context, but here it must be two separate DFs--one for KR and one for VC, as the significant hits differ b/t these normalization schemes anyway.
full.KR[,112:119] &lt;- full.contacts.KR
full.VC[,112:119] &lt;- full.contacts.VC

###As an initial quality control metric, take a look at the mean vs. variance plot for the normalized data--first for KR, then for VC. Also go ahead and add on columns for mean frequencies and variances both within and across the species, while they&#39;re being calculated here anyway:

#KR:
select(full.KR, &quot;A-21792_KR&quot;, &quot;B-28126_KR&quot;, &quot;E-28815_KR&quot;, &quot;F-28834_KR&quot;) %&gt;% apply(., 1, mean) -&gt; full.KR$Hmean
select(full.KR, &quot;C-3649_KR&quot;, &quot;D-40300_KR&quot;, &quot;G-3624_KR&quot;, &quot;H-3651_KR&quot;) %&gt;% apply(., 1, mean) -&gt; full.KR$Cmean
select(full.KR, &quot;A-21792_KR&quot;, &quot;B-28126_KR&quot;, &quot;E-28815_KR&quot;, &quot;F-28834_KR&quot;, &quot;C-3649_KR&quot;, &quot;D-40300_KR&quot;, &quot;G-3624_KR&quot;, &quot;H-3651_KR&quot;) %&gt;% apply(., 1, mean) -&gt; full.KR$ALLmean #Get means across species.
select(full.KR, &quot;A-21792_KR&quot;, &quot;B-28126_KR&quot;, &quot;E-28815_KR&quot;, &quot;F-28834_KR&quot;) %&gt;% apply(., 1, var) -&gt; full.KR$Hvar #Get human variances.
select(full.KR, &quot;C-3649_KR&quot;, &quot;D-40300_KR&quot;, &quot;G-3624_KR&quot;, &quot;H-3651_KR&quot;) %&gt;% apply(., 1, var) -&gt; full.KR$Cvar #Get chimp variances.
select(full.KR, &quot;A-21792_KR&quot;, &quot;B-28126_KR&quot;, &quot;E-28815_KR&quot;, &quot;F-28834_KR&quot;, &quot;C-3649_KR&quot;, &quot;D-40300_KR&quot;, &quot;G-3624_KR&quot;, &quot;H-3651_KR&quot;) %&gt;% apply(., 1, var) -&gt; full.KR$ALLvar #Get variance across species.
{plot(full.KR$ALLmean, full.KR$ALLvar, main=&quot;Mean vs. Variance in Juicer KR contact frequency&quot;, xlab=&quot;Mean Hi-C Contact Frequency&quot;, ylab=&quot;Variance in Hi-C Contact Frequency&quot;)
  abline(lm(full.KR$ALLmean~full.KR$ALLvar), col=&quot;red&quot;)}</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-17.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Very flat line of the regression. Solid looking.

#VC:
select(full.VC, &quot;A-21792_VC&quot;, &quot;B-28126_VC&quot;, &quot;E-28815_VC&quot;, &quot;F-28834_VC&quot;) %&gt;% apply(., 1, mean) -&gt; full.VC$Hmean
select(full.VC, &quot;C-3649_VC&quot;, &quot;D-40300_VC&quot;, &quot;G-3624_VC&quot;, &quot;H-3651_VC&quot;) %&gt;% apply(., 1, mean) -&gt; full.VC$Cmean
select(full.VC, &quot;A-21792_VC&quot;, &quot;B-28126_VC&quot;, &quot;E-28815_VC&quot;, &quot;F-28834_VC&quot;, &quot;C-3649_VC&quot;, &quot;D-40300_VC&quot;, &quot;G-3624_VC&quot;, &quot;H-3651_VC&quot;) %&gt;% apply(., 1, mean) -&gt; full.VC$ALLmean #Get means across species.
select(full.VC, &quot;A-21792_VC&quot;, &quot;B-28126_VC&quot;, &quot;E-28815_VC&quot;, &quot;F-28834_VC&quot;) %&gt;% apply(., 1, var) -&gt; full.VC$Hvar #Get human variances.
select(full.VC, &quot;C-3649_VC&quot;, &quot;D-40300_VC&quot;, &quot;G-3624_VC&quot;, &quot;H-3651_VC&quot;) %&gt;% apply(., 1, var) -&gt; full.VC$Cvar #Get chimp variances.
select(full.VC, &quot;A-21792_VC&quot;, &quot;B-28126_VC&quot;, &quot;E-28815_VC&quot;, &quot;F-28834_VC&quot;, &quot;C-3649_VC&quot;, &quot;D-40300_VC&quot;, &quot;G-3624_VC&quot;, &quot;H-3651_VC&quot;) %&gt;% apply(., 1, var) -&gt; full.VC$ALLvar #Get variance across species.
{plot(full.VC$ALLmean, full.VC$ALLvar, main=&quot;Mean vs. Variance in Juicer VC contact frequency&quot;, xlab=&quot;Mean Hi-C Contact Frequency&quot;, ylab=&quot;Variance in Hi-C Contact Frequency&quot;)
  abline(lm(full.VC$ALLmean~full.VC$ALLvar), col=&quot;red&quot;)}</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-18.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Very flat line of the regression. Solid looking.</code></pre>
<p>On the whole, the distributions look fairly comparable across individuals and species, and the mean vs. variance plots show weak correlation at best between the two metrics. Now knowing the data are comparable in this sense, the next question would be whether they are different enough between the species to separate them from one another with unsupervised clustering and PCA methods.</p>
</div>
<div id="data-clustering-with-principal-components-analysis-pca-and-correlation-heatmap-clustering." class="section level3">
<h3>Data clustering with Principal Components Analysis (PCA) and correlation heatmap clustering.</h3>
<p>Now I use PCA, breaking down the interaction frequency values into principal components that best represent the variability within the data. This technique uses orthogonal transformation to convert the many dimensions in variability of this dataset into a lower-dimensional picture that can be used to separate out functional groups in the data. In this case, the expectation is that the strongest principal component, representing the plurality of the variance, will separate out humans and chimps along its axis, grouping the two species independently, as we expect their interaction frequency values to cluster together. I then also compute pairwise pearson correlations between each of the individuals across all Hi-C contacts, and use unsupervised hierarchical clustering to create a heatmap that once again will group individuals based on similarity in interaction frequency values. Again, I would expect this technique to separate out the species very distinctly from one another.</p>
<pre class="r"><code>###Now do principal components analysis (PCA) on these data to see how they separate:
meta.data &lt;- data.frame(&quot;SP&quot;=c(&quot;H&quot;, &quot;H&quot;, &quot;C&quot;, &quot;C&quot;, &quot;H&quot;, &quot;H&quot;, &quot;C&quot;, &quot;C&quot;), &quot;SX&quot;=c(&quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;), &quot;Batch&quot;=c(1, 1, 1, 1, 2, 2, 2, 2)) #need the metadata first to make this interesting; obtain this information from my study design
pca &lt;- prcomp(t(full.contacts.KR), scale=TRUE, center=TRUE)
pca2 &lt;- prcomp(t(full.contacts.VC), scale=TRUE, center=TRUE)
ggplot(data=as.data.frame(pca$x), aes(x=PC1, y=PC2, shape=as.factor(meta.data$SP), color=as.factor(meta.data$Batch), size=2)) + geom_point() +labs(title=&quot;PCA on KR normalized Hi-C Contact Frequency&quot;) + guides(color=guide_legend(order=1), size=FALSE, shape=guide_legend(order=2)) + xlab(paste(&quot;PC1 (&quot;, 100*summary(pca)$importance[2,1], &quot;% of variance)&quot;)) + ylab((paste(&quot;PC2 (&quot;, 100*summary(pca)$importance[2,2], &quot;% of variance)&quot;))) + labs(color=&quot;Batch&quot;, shape=&quot;Species&quot;) + scale_shape_manual(labels=c(&quot;Chimp&quot;, &quot;Human&quot;), values=c(16, 17))</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Clustering%20w/%20PCA%20and%20Heatmaps-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(summary(pca)$importance[2,], xlab=&quot;PCs&quot;, ylab=&quot;Proportion of Variance Explained&quot;, main=&quot;PCA on KR normalized Hi-C contact frequency&quot;) #Scree plot showing all the PCs and the proportion of the variance they explain.</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Clustering%20w/%20PCA%20and%20Heatmaps-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=as.data.frame(pca2$x), aes(x=PC1, y=PC2, shape=as.factor(meta.data$SP), color=as.factor(meta.data$Batch), size=2)) + geom_point() +labs(title=&quot;PCA on VC normalized Hi-C Contact Frequency&quot;) + guides(color=guide_legend(order=1), size=FALSE, shape=guide_legend(order=2)) + xlab(paste(&quot;PC1 (&quot;, 100*summary(pca)$importance[2,1], &quot;% of variance)&quot;)) + ylab((paste(&quot;PC2 (&quot;, 100*summary(pca)$importance[2,2], &quot;% of variance)&quot;))) + labs(color=&quot;Batch&quot;, shape=&quot;Species&quot;) + scale_shape_manual(labels=c(&quot;Chimp&quot;, &quot;Human&quot;), values=c(16, 17))</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Clustering%20w/%20PCA%20and%20Heatmaps-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(summary(pca2)$importance[2,], xlab=&quot;PCs&quot;, ylab=&quot;Proportion of Variance Explained&quot;, main=&quot;PCA on VC normalized Hi-C contact frequency&quot;)</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Clustering%20w/%20PCA%20and%20Heatmaps-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Scree plot</code></pre>
</div>
<div id="variance-exploration" class="section level3">
<h3>Variance exploration</h3>
<p>Now I look at several metrics to assess variance in the data, checking which species hits were discovered as significant in and how many individuals a given hit was discovered in. I look at this to understand if there are some cutoffs that should be made to reduce the noisiness of the data and maximize the significance of further findings.</p>
<pre class="r"><code>###Add columns to full.data to indicate species of discovery and number of individuals discovered in. These pieces of information are good to know about each of the hits generally, but can also be used to make decisions about filtering out certain classes of hits if variance is associated with any of these metrics.  
humNAs &lt;- rowSums(is.na(full.KR[,1:53])) #52 is when there is no human info. 13 NAs per individual.
chimpNAs &lt;- rowSums(is.na(full.KR[,54:105])) #Same as above of course.
full.KR$found_in_H &lt;- (4-humNAs/13) #Set a new column identifying number of humans hit was found in
full.KR$found_in_C &lt;- (4-chimpNAs/13) #Set a new column identifying number of chimps hit was found in
full.KR$disc_species &lt;- ifelse(full.KR$found_in_C&gt;0&amp;full.KR$found_in_H&gt;0, &quot;B&quot;, ifelse(full.KR$found_in_C==0, &quot;H&quot;, &quot;C&quot;)) #Set a column identifying which species (H, C, or Both) the hit in question was identified in. Works with nested ifelses.
full.KR$tot_indiv_IDd &lt;- full.KR$found_in_C+full.KR$found_in_H #Add a column specifying total number of individuals homer found the significant hit in.

###Take a look at what proportion of the significant hits were discovered in either of the species (or both of them).
sum(full.KR$disc_species==&quot;H&quot;) #~9.5k</code></pre>
<pre><code>[1] 9526</code></pre>
<pre class="r"><code>sum(full.KR$disc_species==&quot;C&quot;) #~12k</code></pre>
<pre><code>[1] 11916</code></pre>
<pre class="r"><code>sum(full.KR$disc_species==&quot;B&quot;) #~7k</code></pre>
<pre><code>[1] 6736</code></pre>
<pre class="r"><code>#This is reassuring, as similar numbers of discoveries in both species suggests comparable power for detection.

###Now I look at variance in interaction frequency as a function of the number of individuals in which a pair was independently called as significant. Essentially, I&#39;m checking here to see if there is some kind of cutoff I should make for the significant hits--i.e., if the variance looks to drop off significantly after a hit is discovered in at least 2 individuals, this suggests possibly filtering out any hit only discovered in 1 individual.
myplot &lt;- data.frame(disc_species=full.KR$disc_species, found_in_H=full.KR$found_in_H, found_in_C=full.KR$found_in_C, tot_indiv_IDd=full.KR$tot_indiv_IDd, Hvar=full.KR$Hvar, Cvar=full.KR$Cvar, ALLvar=full.KR$ALLvar)
ggplot(data=myplot, aes(group=tot_indiv_IDd, x=tot_indiv_IDd, y=ALLvar)) + geom_boxplot() + ggtitle(&quot;Number of Individuals a Hi-C Hit is Discovered in vs. Variance&quot;) + xlab(&quot;# Individuals where Hi-C contact called significant&quot;) + ylab(&quot;Variance in KR Interaction Frequency&quot;) + coord_cartesian(ylim=c(0, 10))</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=myplot, aes(group=tot_indiv_IDd, x=tot_indiv_IDd, y=ALLvar)) + geom_boxplot() + scale_y_continuous(limits=c(0, 1)) + ggtitle(&quot;Number of Individuals a Hi-C Hit is Discovered in vs. Variance&quot;) + xlab(&quot;# Individuals where Hi-C contact called significant&quot;) + ylab(&quot;Variance in KR Interaction Frequency&quot;)</code></pre>
<pre><code>Warning: Removed 4631 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#There appears to be no clear trend here; simply decide to require a hit is discovered in at least 2 individuals to call it as biologically significant and not just technical nonsense? Do the same process for the VC data after this as well:
filt.KR &lt;- filter(full.KR, tot_indiv_IDd&gt;=2) #Brings us down from ~13k hits to only 4k hits though...


###EXACT same thing for VC data:
humNAs &lt;- rowSums(is.na(full.VC[,1:53])) #52 is when there is no human info. 13 NAs per individual.
chimpNAs &lt;- rowSums(is.na(full.VC[,54:105])) #Same as above of course.
full.VC$found_in_H &lt;- (4-humNAs/13) #Set a new column identifying number of humans hit was found in
full.VC$found_in_C &lt;- (4-chimpNAs/13) #Set a new column identifying number of chimps hit was found in
full.VC$disc_species &lt;- ifelse(full.VC$found_in_C&gt;0&amp;full.VC$found_in_H&gt;0, &quot;B&quot;, ifelse(full.VC$found_in_C==0, &quot;H&quot;, &quot;C&quot;)) #Set a column identifying which species (H, C, or Both) the hit in question was identified in. Works with nested ifelses.
full.VC$tot_indiv_IDd &lt;- full.VC$found_in_C+full.VC$found_in_H #Add a column specifying total number of individuals homer found the significant hit in.

###Take a look at what proportion of the significant hits were discovered in either of the species (or both of them).
sum(full.VC$disc_species==&quot;H&quot;) #~56k</code></pre>
<pre><code>[1] 55851</code></pre>
<pre class="r"><code>sum(full.VC$disc_species==&quot;C&quot;) #~12k</code></pre>
<pre><code>[1] 11718</code></pre>
<pre class="r"><code>sum(full.VC$disc_species==&quot;B&quot;) #~9k</code></pre>
<pre><code>[1] 9228</code></pre>
<pre class="r"><code>#This is the opposite of reassuring, as different numbers of discoveries in both species suggests incomparable power for detection...how is the coverage normalization making such a big difference here for humans?! I need to probably go back and look at my initial subsetting and significance calling and extraction again to make sure it&#39;s all right...

###Now I look at variance in interaction frequency as a function of the number of individuals in which a pair was independently called as significant. Essentially, I&#39;m checking here to see if there is some kind of cutoff I should make for the significant hits--i.e., if the variance looks to drop off significantly after a hit is discovered in at least 2 individuals, this suggests possibly filtering out any hit only discovered in 1 individual.
myplot &lt;- data.frame(disc_species=full.VC$disc_species, found_in_H=full.VC$found_in_H, found_in_C=full.VC$found_in_C, tot_indiv_IDd=full.VC$tot_indiv_IDd, Hvar=full.VC$Hvar, Cvar=full.VC$Cvar, ALLvar=full.VC$ALLvar)
ggplot(data=myplot, aes(group=tot_indiv_IDd, x=tot_indiv_IDd, y=ALLvar)) + geom_boxplot() + ggtitle(&quot;Number of Individuals a Hi-C Hit is Discovered in vs. Variance&quot;) + xlab(&quot;# Individuals where Hi-C contact called significant&quot;) + ylab(&quot;Variance in VC Interaction Frequency&quot;) + coord_cartesian(ylim=c(0, 10))</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=myplot, aes(group=tot_indiv_IDd, x=tot_indiv_IDd, y=ALLvar)) + geom_boxplot() + scale_y_continuous(limits=c(0, 1)) + ggtitle(&quot;Number of Individuals a Hi-C Hit is Discovered in vs. Variance&quot;) + xlab(&quot;# Individuals where Hi-C contact called significant&quot;) + ylab(&quot;Variance in VC Interaction Frequency&quot;)</code></pre>
<pre><code>Warning: Removed 21571 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#There appears to be no clear trend here; simply decide to require a hit is discovered in at least 2 individuals to call it as biologically significant and not just technical nonsense?
filt.VC &lt;- filter(full.VC, tot_indiv_IDd&gt;=2) #Brings us down from ~13k hits to only 4k hits though...


sum(filt.VC$disc_species==&quot;H&quot;) #~4k</code></pre>
<pre><code>[1] 3991</code></pre>
<pre class="r"><code>sum(filt.VC$disc_species==&quot;C&quot;) #~2.5k</code></pre>
<pre><code>[1] 2448</code></pre>
<pre class="r"><code>sum(filt.VC$disc_species==&quot;B&quot;) #~9k</code></pre>
<pre><code>[1] 9228</code></pre>
<pre class="r"><code>sum(filt.KR$disc_species==&quot;H&quot;) #~56k</code></pre>
<pre><code>[1] 2136</code></pre>
<pre class="r"><code>sum(filt.KR$disc_species==&quot;C&quot;) #~12k</code></pre>
<pre><code>[1] 2824</code></pre>
<pre class="r"><code>sum(filt.KR$disc_species==&quot;B&quot;) #~9k</code></pre>
<pre><code>[1] 6736</code></pre>
<pre class="r"><code>###Take one last look at the new distributions after doing the filtering, just to see what they look like, and also take a look at the PCA and hierarchical clustering, just for reference (don&#39;t really think it matters at this point?):
VC.humans &lt;- melt(filt.VC[,c(112:113, 116:117)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>VC.chimps &lt;- melt(filt.VC[,c(114:115, 118:119)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>KR.humans &lt;- melt(filt.KR[,c(112:113, 116:117)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>KR.chimps &lt;- melt(filt.KR[,c(114:115, 118:119)])</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>#VC-normalized distributions:
ggplot(data=VC.humans, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Humans&quot;) + xlab(&quot;Juicer VC-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 750)) #Human dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=VC.chimps, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Chimps&quot;) + xlab(&quot;Juicer VC-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 750)) #Chimp Dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-6.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Both sets of distributions look fairly bimodal, with chimps in particular showing a peak around 0.

###Now, the same thing for the KR-normalized interaction frequencies:
ggplot(data=KR.humans, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Humans&quot;) + xlab(&quot;Juicer KR-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 500)) #Human dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=KR.chimps, aes(x=value)) + geom_histogram(binwidth=0.1, aes(group=variable)) + facet_wrap(~as.factor(variable)) + ggtitle(&quot;Distributions of Juicer-Significant Hi-C Contacts, Chimps&quot;) + xlab(&quot;Juicer KR-Normalized Interaction Frequency&quot;) + coord_cartesian(xlim=c(-1, 12), ylim=c(0, 500)) #Chimp Dist&#39;ns</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>####Check on clustering and PCA now:
corheat &lt;- cor(filt.KR[,112:119], use=&quot;complete.obs&quot;, method=&quot;pearson&quot;) #Corheat for the full data set, and heatmap. Pearson clusters poorly.
corheats &lt;- cor(filt.KR[,112:119], use=&quot;complete.obs&quot;, method=&quot;spearman&quot;)
colnames(corheat) &lt;- c(&quot;A_HF&quot;, &quot;B_HM&quot;, &quot;C_CM&quot;, &quot;D_CF&quot;, &quot;E_HM&quot;, &quot;F_HF&quot;, &quot;G_CM&quot;, &quot;H_CF&quot;)
rownames(corheat) &lt;- colnames(corheat)
colnames(corheats) &lt;- colnames(corheat)
rownames(corheats) &lt;- colnames(corheat)

#KR Clustering
heatmaply(corheat, main=&quot;Pairwise Pearson Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Clusters poorly, but at least species groups are maintained!</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="e21a34047777" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21a34047777">{"x":{"data":[{"x":[3.421875,5.84375,null,5.84375,5.84375,null,5.84375,3.6875,null,3.6875,3.6875,null,3.6875,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.6875,4.875,null,4.875,4.875,null,4.875,4,null,4,4,null,4.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,5.84375,8,null,8,8],"y":[0.0550652449558089,0.0550652449558089,null,0.0550652449558089,0.041471741189891,null,0.041471741189891,0.041471741189891,null,0.041471741189891,0.029671213419249,null,0.029671213419249,0.029671213419249,null,0.029671213419249,0.0177125565785412,null,0.0177125565785412,0.0177125565785412,null,0.0177125565785412,0,null,0.0177125565785412,0.0177125565785412,null,0.0177125565785412,0,null,0.029671213419249,0.029671213419249,null,0.029671213419249,0.0232484754410649,null,0.0232484754410649,0.0232484754410649,null,0.0232484754410649,0,null,0.0232484754410649,0.0232484754410649,null,0.0232484754410649,0.010910513604938,null,0.010910513604938,0.010910513604938,null,0.010910513604938,0,null,0.010910513604938,0.010910513604938,null,0.010910513604938,0.00601956716615057,null,0.00601956716615057,0.00601956716615057,null,0.00601956716615057,0,null,0.00601956716615057,0.00601956716615057,null,0.00601956716615057,0,null,0.041471741189891,0.041471741189891,null,0.041471741189891,0],"text":["y: 0.055065245","y: 0.055065245",null,"y: 0.055065245","y: 0.055065245",null,"y: 0.041471741","y: 0.041471741",null,"y: 0.041471741","y: 0.041471741",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.041471741","y: 0.041471741",null,"y: 0.041471741","y: 0.041471741"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.421875,1,null,1,1],"y":[0.0550652449558089,0.0550652449558089,null,0.0550652449558089,0],"text":"y: 0.055065245","type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.421875,1,5.84375,3.6875,2.5,2,3,4.875,4,5.75,5,6.5,6,7,8],"y":[0.0550652449558089,0,0.041471741189891,0.029671213419249,0.0177125565785412,0,0,0.0232484754410649,0,0.010910513604938,0,0.00601956716615057,0,0,0],"text":["y: 0.055065245","y: 0.000000000","y: 0.041471741","y: 0.029671213","y: 0.017712557","y: 0.000000000","y: 0.000000000","y: 0.023248475","y: 0.000000000","y: 0.010910514","y: 0.000000000","y: 0.006019567","y: 0.000000000","y: 0.000000000","y: 0.000000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.702620322551633,0.600806913390785,0.554056167329177,0.607368962257511,0.426603181777536,0.419178985928848,0],[0.702620322551633,1,0.699891580441659,0.559992321034696,0.657883641058163,0.672655553840892,0.639456356601993,0.357975854643627],[0.600806913390785,0.699891580441659,1,0.610663995594867,0.688009018216167,0.79127850211773,0.690888236617205,0.572570114975429],[0.554056167329177,0.559992321034696,0.610663995594867,1,0.696819677241962,0.667401462393765,0.696130526845481,0.545054634917423],[0.607368962257511,0.657883641058163,0.688009018216167,0.696819677241962,1,0.871116404640217,0.902658511100841,0.693444532042782],[0.426603181777536,0.672655553840892,0.79127850211773,0.667401462393765,0.871116404640217,1,0.909942549245185,0.833850953721881],[0.419178985928848,0.639456356601993,0.690888236617205,0.696130526845481,0.902658511100841,0.909942549245185,1,0.85323887037629],[0,0.357975854643627,0.572570114975429,0.545054634917423,0.693444532042782,0.833850953721881,0.85323887037629,1]],"text":[["row: E_HM<br>column: E_HM<br>value: 1.0000","row: E_HM<br>column: B_HM<br>value: 0.9896","row: E_HM<br>column: A_HF<br>value: 0.9860","row: E_HM<br>column: F_HF<br>value: 0.9844","row: E_HM<br>column: C_CM<br>value: 0.9863","row: E_HM<br>column: D_CF<br>value: 0.9800","row: E_HM<br>column: G_CM<br>value: 0.9797","row: E_HM<br>column: H_CF<br>value: 0.9650"],["row: B_HM<br>column: E_HM<br>value: 0.9896","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: A_HF<br>value: 0.9895","row: B_HM<br>column: F_HF<br>value: 0.9846","row: B_HM<br>column: C_CM<br>value: 0.9880","row: B_HM<br>column: D_CF<br>value: 0.9886","row: B_HM<br>column: G_CM<br>value: 0.9874","row: B_HM<br>column: H_CF<br>value: 0.9776"],["row: A_HF<br>column: E_HM<br>value: 0.9860","row: A_HF<br>column: B_HM<br>value: 0.9895","row: A_HF<br>column: A_HF<br>value: 1.0000","row: A_HF<br>column: F_HF<br>value: 0.9864","row: A_HF<br>column: C_CM<br>value: 0.9891","row: A_HF<br>column: D_CF<br>value: 0.9927","row: A_HF<br>column: G_CM<br>value: 0.9892","row: A_HF<br>column: H_CF<br>value: 0.9851"],["row: F_HF<br>column: E_HM<br>value: 0.9844","row: F_HF<br>column: B_HM<br>value: 0.9846","row: F_HF<br>column: A_HF<br>value: 0.9864","row: F_HF<br>column: F_HF<br>value: 1.0000","row: F_HF<br>column: C_CM<br>value: 0.9894","row: F_HF<br>column: D_CF<br>value: 0.9884","row: F_HF<br>column: G_CM<br>value: 0.9894","row: F_HF<br>column: H_CF<br>value: 0.9841"],["row: C_CM<br>column: E_HM<br>value: 0.9863","row: C_CM<br>column: B_HM<br>value: 0.9880","row: C_CM<br>column: A_HF<br>value: 0.9891","row: C_CM<br>column: F_HF<br>value: 0.9894","row: C_CM<br>column: C_CM<br>value: 1.0000","row: C_CM<br>column: D_CF<br>value: 0.9955","row: C_CM<br>column: G_CM<br>value: 0.9966","row: C_CM<br>column: H_CF<br>value: 0.9893"],["row: D_CF<br>column: E_HM<br>value: 0.9800","row: D_CF<br>column: B_HM<br>value: 0.9886","row: D_CF<br>column: A_HF<br>value: 0.9927","row: D_CF<br>column: F_HF<br>value: 0.9884","row: D_CF<br>column: C_CM<br>value: 0.9955","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: G_CM<br>value: 0.9969","row: D_CF<br>column: H_CF<br>value: 0.9942"],["row: G_CM<br>column: E_HM<br>value: 0.9797","row: G_CM<br>column: B_HM<br>value: 0.9874","row: G_CM<br>column: A_HF<br>value: 0.9892","row: G_CM<br>column: F_HF<br>value: 0.9894","row: G_CM<br>column: C_CM<br>value: 0.9966","row: G_CM<br>column: D_CF<br>value: 0.9969","row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: H_CF<br>value: 0.9949"],["row: H_CF<br>column: E_HM<br>value: 0.9650","row: H_CF<br>column: B_HM<br>value: 0.9776","row: H_CF<br>column: A_HF<br>value: 0.9851","row: H_CF<br>column: F_HF<br>value: 0.9841","row: H_CF<br>column: C_CM<br>value: 0.9893","row: H_CF<br>column: D_CF<br>value: 0.9942","row: H_CF<br>column: G_CM<br>value: 0.9949","row: H_CF<br>column: H_CF<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.357975854643627,"#2E6E8E"],[0.419178985928848,"#287D8E"],[0.426603181777536,"#277F8E"],[0.545054634917423,"#1E9B8A"],[0.554056167329177,"#1E9D89"],[0.559992321034696,"#1F9F88"],[0.572570114975429,"#1FA187"],[0.600806913390785,"#22A884"],[0.607368962257511,"#24AA83"],[0.610663995594867,"#25AB82"],[0.639456356601993,"#2CB17E"],[0.657883641058163,"#32B67A"],[0.667401462393765,"#35B779"],[0.672655553840892,"#38B977"],[0.688009018216167,"#3EBC74"],[0.690888236617205,"#3FBC73"],[0.693444532042782,"#40BD72"],[0.696130526845481,"#41BE71"],[0.696819677241962,"#41BE71"],[0.699891580441659,"#43BE71"],[0.702620322551633,"#44BF70"],[0.79127850211773,"#75D054"],[0.833850953721881,"#8FD744"],[0.85323887037629,"#9CD93B"],[0.871116404640217,"#A8DB34"],[0.902658511100841,"#BEDF26"],[0.909942549245185,"#C2DF23"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_c1e1f4fed90e7f0d217b734f972fe152","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#460B5E"],[0.0588235294117647,"#482071"],[0.117647058823529,"#46327E"],[0.176470588235294,"#414487"],[0.235294117647059,"#3A538B"],[0.294117647058824,"#33638D"],[0.352941176470588,"#2C718E"],[0.411764705882353,"#277F8E"],[0.470588235294118,"#228D8D"],[0.529411764705882,"#1F9A8A"],[0.588235294117647,"#22A884"],[0.647058823529412,"#31B57B"],[0.705882352941177,"#4AC16D"],[0.764705882352941,"#68CD5B"],[0.823529411764706,"#8CD646"],[0.882352941176471,"#B2DD2D"],[0.941176470588235,"#D9E219"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.97","0.98","0.99","1.00"],"tickvals":[0.117647058823529,0.411764705882353,0.705882352941177,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.0550652449558089,0.0550652449558089,null,0.0550652449558089,0.041471741189891,null,0.041471741189891,0.041471741189891,null,0.041471741189891,0.029671213419249,null,0.029671213419249,0.029671213419249,null,0.029671213419249,0.0177125565785412,null,0.0177125565785412,0.0177125565785412,null,0.0177125565785412,0,null,0.0177125565785412,0.0177125565785412,null,0.0177125565785412,0,null,0.029671213419249,0.029671213419249,null,0.029671213419249,0.0232484754410649,null,0.0232484754410649,0.0232484754410649,null,0.0232484754410649,0,null,0.0232484754410649,0.0232484754410649,null,0.0232484754410649,0.010910513604938,null,0.010910513604938,0.010910513604938,null,0.010910513604938,0,null,0.010910513604938,0.010910513604938,null,0.010910513604938,0.00601956716615057,null,0.00601956716615057,0.00601956716615057,null,0.00601956716615057,0,null,0.00601956716615057,0.00601956716615057,null,0.00601956716615057,0,null,0.041471741189891,0.041471741189891,null,0.041471741189891,0],"y":[3.421875,5.84375,null,5.84375,5.84375,null,5.84375,3.6875,null,3.6875,3.6875,null,3.6875,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.6875,4.875,null,4.875,4.875,null,4.875,4,null,4,4,null,4.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,5.84375,8,null,8,8],"text":["y: 0.055065245","y: 0.055065245",null,"y: 0.055065245","y: 0.055065245",null,"y: 0.041471741","y: 0.041471741",null,"y: 0.041471741","y: 0.041471741",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.017712557","y: 0.017712557",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.029671213","y: 0.029671213",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.023248475","y: 0.023248475",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.010910514","y: 0.010910514",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.006019567","y: 0.006019567",null,"y: 0.041471741","y: 0.041471741",null,"y: 0.041471741","y: 0.041471741"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.0550652449558089,0.0550652449558089,null,0.0550652449558089,0],"y":[3.421875,1,null,1,1],"text":"y: 0.055065245","type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.0550652449558089,0,0.041471741189891,0.029671213419249,0.0177125565785412,0,0,0.0232484754410649,0,0.010910513604938,0,0.00601956716615057,0,0,0],"y":[3.421875,1,5.84375,3.6875,2.5,2,3,4.875,4,5.75,5,6.5,6,7,8],"text":["y: 0.055065245","y: 0.000000000","y: 0.041471741","y: 0.029671213","y: 0.017712557","y: 0.000000000","y: 0.000000000","y: 0.023248475","y: 0.000000000","y: 0.010910514","y: 0.000000000","y: 0.006019567","y: 0.000000000","y: 0.000000000","y: 0.000000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["E_HM","B_HM","A_HF","F_HF","C_CM","D_CF","G_CM","H_CF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.0550652449558089],"ticktext":["0.00","0.01","0.02","0.03","0.04","0.05"],"tickvals":[0,0.01,0.02,0.03,0.04,0.05],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["E_HM","B_HM","A_HF","F_HF","C_CM","D_CF","G_CM","H_CF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.0550652449558089],"ticktext":["0.00","0.01","0.02","0.03","0.04","0.05"],"tickvals":[0,0.01,0.02,0.03,0.04,0.05],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Pearson Correlation @ 10kb"},"attrs":{"e21a4e39e4ad":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a3ad441fa":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a7ea7eea5":{"alpha":1,"sizes":[10,100]},"e21a1f0aa44b":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a4cb632bf":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a4dbdc0f1":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>heatmaply(corheats, main=&quot;Pairwise Spearman Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Clusters excellently!</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="e21a7e9b42eb" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21a7e9b42eb">{"x":{"data":[{"x":[4.8125,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"y":[0.570211968474103,0.570211968474103,null,0.570211968474103,0.309409257162119,null,0.309409257162119,0.309409257162119,null,0.309409257162119,0.234774006438853,null,0.234774006438853,0.234774006438853,null,0.234774006438853,0.156275364774394,null,0.156275364774394,0.156275364774394,null,0.156275364774394,0,null,0.156275364774394,0.156275364774394,null,0.156275364774394,0,null,0.234774006438853,0.234774006438853,null,0.234774006438853,0,null,0.309409257162119,0.309409257162119,null,0.309409257162119,0],"text":["y: 0.5702120","y: 0.5702120",null,"y: 0.5702120","y: 0.5702120",null,"y: 0.3094093","y: 0.3094093",null,"y: 0.3094093","y: 0.3094093",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.3094093","y: 0.3094093",null,"y: 0.3094093","y: 0.3094093"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8125,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[0.570211968474103,0.570211968474103,null,0.570211968474103,0.187302902971629,null,0.187302902971629,0.187302902971629,null,0.187302902971629,0.140788709644584,null,0.140788709644584,0.140788709644584,null,0.140788709644584,0,null,0.140788709644584,0.140788709644584,null,0.140788709644584,0,null,0.187302902971629,0.187302902971629,null,0.187302902971629,0.155668208791177,null,0.155668208791177,0.155668208791177,null,0.155668208791177,0,null,0.155668208791177,0.155668208791177,null,0.155668208791177,0],"text":["y: 0.5702120","y: 0.5702120",null,"y: 0.5702120","y: 0.5702120",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1556682","y: 0.1556682",null,"y: 0.1556682","y: 0.1556682",null,"y: 0.1556682","y: 0.1556682",null,"y: 0.1556682","y: 0.1556682"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.8125,2.5,1.5,1,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"y":[0.570211968474103,0.187302902971629,0.140788709644584,0,0,0.155668208791177,0,0,0.309409257162119,0.234774006438853,0.156275364774394,0,0,0,0],"text":["y: 0.5702120","y: 0.1873029","y: 0.1407887","y: 0.0000000","y: 0.0000000","y: 0.1556682","y: 0.0000000","y: 0.0000000","y: 0.3094093","y: 0.2347740","y: 0.1562754","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.692202363094652,0.661394897583871,0.640325673080923,0.371785286997967,0.305129661592231,0.175744375708646,0],[0.692202363094652,1,0.666781433621976,0.635297273175903,0.361491569544983,0.308653611496068,0.156193554063425,0.0106411166436219],[0.661394897583871,0.666781433621976,1,0.662681796440279,0.439198953595599,0.398972548978149,0.260515176929136,0.141413994114274],[0.640325673080923,0.635297273175903,0.662681796440279,1,0.45904702109438,0.427086332165902,0.268795130969233,0.188399295650768],[0.371785286997967,0.361491569544983,0.439198953595599,0.45904702109438,1,0.668700693543309,0.569468995919169,0.511768087254997],[0.305129661592231,0.308653611496068,0.398972548978149,0.427086332165902,0.668700693543309,1,0.583256738728278,0.580300368311738],[0.175744375708646,0.156193554063425,0.260515176929136,0.268795130969233,0.569468995919169,0.583256738728278,1,0.46664118785884],[0,0.0106411166436219,0.141413994114274,0.188399295650768,0.511768087254997,0.580300368311738,0.46664118785884,1]],"text":[["row: C_CM<br>column: C_CM<br>value: 1.0000","row: C_CM<br>column: G_CM<br>value: 0.9006","row: C_CM<br>column: H_CF<br>value: 0.8907","row: C_CM<br>column: D_CF<br>value: 0.8839","row: C_CM<br>column: F_HF<br>value: 0.7972","row: C_CM<br>column: B_HM<br>value: 0.7756","row: C_CM<br>column: E_HM<br>value: 0.7339","row: C_CM<br>column: A_HF<br>value: 0.6771"],["row: G_CM<br>column: C_CM<br>value: 0.9006","row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: H_CF<br>value: 0.8924","row: G_CM<br>column: D_CF<br>value: 0.8822","row: G_CM<br>column: F_HF<br>value: 0.7938","row: G_CM<br>column: B_HM<br>value: 0.7768","row: G_CM<br>column: E_HM<br>value: 0.7276","row: G_CM<br>column: A_HF<br>value: 0.6806"],["row: H_CF<br>column: C_CM<br>value: 0.8907","row: H_CF<br>column: G_CM<br>value: 0.8924","row: H_CF<br>column: H_CF<br>value: 1.0000","row: H_CF<br>column: D_CF<br>value: 0.8911","row: H_CF<br>column: F_HF<br>value: 0.8189","row: H_CF<br>column: B_HM<br>value: 0.8059","row: H_CF<br>column: E_HM<br>value: 0.7612","row: H_CF<br>column: A_HF<br>value: 0.7228"],["row: D_CF<br>column: C_CM<br>value: 0.8839","row: D_CF<br>column: G_CM<br>value: 0.8822","row: D_CF<br>column: H_CF<br>value: 0.8911","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: F_HF<br>value: 0.8253","row: D_CF<br>column: B_HM<br>value: 0.8150","row: D_CF<br>column: E_HM<br>value: 0.7639","row: D_CF<br>column: A_HF<br>value: 0.7380"],["row: F_HF<br>column: C_CM<br>value: 0.7972","row: F_HF<br>column: G_CM<br>value: 0.7938","row: F_HF<br>column: H_CF<br>value: 0.8189","row: F_HF<br>column: D_CF<br>value: 0.8253","row: F_HF<br>column: F_HF<br>value: 1.0000","row: F_HF<br>column: B_HM<br>value: 0.8930","row: F_HF<br>column: E_HM<br>value: 0.8610","row: F_HF<br>column: A_HF<br>value: 0.8424"],["row: B_HM<br>column: C_CM<br>value: 0.7756","row: B_HM<br>column: G_CM<br>value: 0.7768","row: B_HM<br>column: H_CF<br>value: 0.8059","row: B_HM<br>column: D_CF<br>value: 0.8150","row: B_HM<br>column: F_HF<br>value: 0.8930","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: E_HM<br>value: 0.8654","row: B_HM<br>column: A_HF<br>value: 0.8645"],["row: E_HM<br>column: C_CM<br>value: 0.7339","row: E_HM<br>column: G_CM<br>value: 0.7276","row: E_HM<br>column: H_CF<br>value: 0.7612","row: E_HM<br>column: D_CF<br>value: 0.7639","row: E_HM<br>column: F_HF<br>value: 0.8610","row: E_HM<br>column: B_HM<br>value: 0.8654","row: E_HM<br>column: E_HM<br>value: 1.0000","row: E_HM<br>column: A_HF<br>value: 0.8278"],["row: A_HF<br>column: C_CM<br>value: 0.6771","row: A_HF<br>column: G_CM<br>value: 0.6806","row: A_HF<br>column: H_CF<br>value: 0.7228","row: A_HF<br>column: D_CF<br>value: 0.7380","row: A_HF<br>column: F_HF<br>value: 0.8424","row: A_HF<br>column: B_HM<br>value: 0.8645","row: A_HF<br>column: E_HM<br>value: 0.8278","row: A_HF<br>column: A_HF<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.0106411166436219,"#450558"],[0.141413994114274,"#46327E"],[0.156193554063425,"#453781"],[0.175744375708646,"#433D84"],[0.188399295650768,"#424086"],[0.260515176929136,"#3A548C"],[0.268795130969233,"#38578C"],[0.305129661592231,"#34618D"],[0.308653611496068,"#33628D"],[0.361491569544983,"#2E6F8E"],[0.371785286997967,"#2C718E"],[0.398972548978149,"#2A788E"],[0.427086332165902,"#277F8E"],[0.439198953595599,"#26828E"],[0.45904702109438,"#24868E"],[0.46664118785884,"#23888E"],[0.511768087254997,"#20938C"],[0.569468995919169,"#1FA188"],[0.580300368311738,"#20A386"],[0.583256738728278,"#20A486"],[0.635297273175903,"#2AB07F"],[0.640325673080923,"#2CB17E"],[0.661394897583871,"#33B679"],[0.662681796440279,"#34B679"],[0.666781433621976,"#35B779"],[0.668700693543309,"#36B878"],[0.692202363094652,"#40BD72"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_988614b579ec94f80c6e4b6a700eb56d","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#450458"],[0.0625000000000001,"#481B6D"],[0.125,"#472F7D"],[0.1875,"#414287"],[0.25,"#3A538B"],[0.3125,"#32648E"],[0.375,"#2C738E"],[0.4375,"#26828E"],[0.5,"#20928C"],[0.5625,"#1FA088"],[0.625,"#28AE80"],[0.6875,"#3FBC73"],[0.75,"#5EC962"],[0.8125,"#83D44C"],[0.875,"#ABDC31"],[0.9375,"#D6E21A"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.7","0.8","0.9","1.0"],"tickvals":[0.0625000000000001,0.375,0.6875,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.570211968474103,0.570211968474103,null,0.570211968474103,0.309409257162119,null,0.309409257162119,0.309409257162119,null,0.309409257162119,0.234774006438853,null,0.234774006438853,0.234774006438853,null,0.234774006438853,0.156275364774394,null,0.156275364774394,0.156275364774394,null,0.156275364774394,0,null,0.156275364774394,0.156275364774394,null,0.156275364774394,0,null,0.234774006438853,0.234774006438853,null,0.234774006438853,0,null,0.309409257162119,0.309409257162119,null,0.309409257162119,0],"y":[4.8125,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"text":["y: 0.5702120","y: 0.5702120",null,"y: 0.5702120","y: 0.5702120",null,"y: 0.3094093","y: 0.3094093",null,"y: 0.3094093","y: 0.3094093",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.1562754","y: 0.1562754",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.2347740","y: 0.2347740",null,"y: 0.3094093","y: 0.3094093",null,"y: 0.3094093","y: 0.3094093"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.570211968474103,0.570211968474103,null,0.570211968474103,0.187302902971629,null,0.187302902971629,0.187302902971629,null,0.187302902971629,0.140788709644584,null,0.140788709644584,0.140788709644584,null,0.140788709644584,0,null,0.140788709644584,0.140788709644584,null,0.140788709644584,0,null,0.187302902971629,0.187302902971629,null,0.187302902971629,0.155668208791177,null,0.155668208791177,0.155668208791177,null,0.155668208791177,0,null,0.155668208791177,0.155668208791177,null,0.155668208791177,0],"y":[4.8125,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"text":["y: 0.5702120","y: 0.5702120",null,"y: 0.5702120","y: 0.5702120",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1407887","y: 0.1407887",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1873029","y: 0.1873029",null,"y: 0.1556682","y: 0.1556682",null,"y: 0.1556682","y: 0.1556682",null,"y: 0.1556682","y: 0.1556682",null,"y: 0.1556682","y: 0.1556682"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.570211968474103,0.187302902971629,0.140788709644584,0,0,0.155668208791177,0,0,0.309409257162119,0.234774006438853,0.156275364774394,0,0,0,0],"y":[4.8125,2.5,1.5,1,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"text":["y: 0.5702120","y: 0.1873029","y: 0.1407887","y: 0.0000000","y: 0.0000000","y: 0.1556682","y: 0.0000000","y: 0.0000000","y: 0.3094093","y: 0.2347740","y: 0.1562754","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["C_CM","G_CM","H_CF","D_CF","F_HF","B_HM","E_HM","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.570211968474103],"ticktext":["0.0","0.1","0.2","0.3","0.4","0.5"],"tickvals":[0,0.1,0.2,0.3,0.4,0.5],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["C_CM","G_CM","H_CF","D_CF","F_HF","B_HM","E_HM","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.570211968474103],"ticktext":["0.0","0.1","0.2","0.3","0.4","0.5"],"tickvals":[0,0.1,0.2,0.3,0.4,0.5],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Spearman Correlation @ 10kb"},"attrs":{"e21a224a4ea":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a33c6ffbf":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a26d518a":{"alpha":1,"sizes":[10,100]},"e21a31284f2e":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a7264f118":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a41109954":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>#FOR KR, after filtering, Spearman holds up perfectly, Pearson has slight issues (dendrogram isn&#39;t right although larger groups clustered properly)

##Repeat for VC before looking at PCA on both:
corheat &lt;- cor(filt.VC[,112:119], use=&quot;complete.obs&quot;, method=&quot;pearson&quot;) #Corheat for the full data set, and heatmap. Pearson clusters poorly.
corheats &lt;- cor(filt.VC[,112:119], use=&quot;complete.obs&quot;, method=&quot;spearman&quot;)
colnames(corheat) &lt;- c(&quot;A_HF&quot;, &quot;B_HM&quot;, &quot;C_CM&quot;, &quot;D_CF&quot;, &quot;E_HM&quot;, &quot;F_HF&quot;, &quot;G_CM&quot;, &quot;H_CF&quot;)
rownames(corheat) &lt;- colnames(corheat)
colnames(corheats) &lt;- colnames(corheat)
rownames(corheats) &lt;- colnames(corheat)

#KR Clustering
heatmaply(corheat, main=&quot;Pairwise Pearson Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Clusters poorly, but at least species groups are maintained!</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="e21ae173cde" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21ae173cde">{"x":{"data":[{"x":[3.421875,5.84375,null,5.84375,5.84375,null,5.84375,3.6875,null,3.6875,3.6875,null,3.6875,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.6875,4.875,null,4.875,4.875,null,4.875,4,null,4,4,null,4.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,5.84375,8,null,8,8],"y":[0.243310438709443,0.243310438709443,null,0.243310438709443,0.151073643578534,null,0.151073643578534,0.151073643578534,null,0.151073643578534,0.0901647789928727,null,0.0901647789928727,0.0901647789928727,null,0.0901647789928727,0.0457867257664635,null,0.0457867257664635,0.0457867257664635,null,0.0457867257664635,0,null,0.0457867257664635,0.0457867257664635,null,0.0457867257664635,0,null,0.0901647789928727,0.0901647789928727,null,0.0901647789928727,0.0776296480486416,null,0.0776296480486416,0.0776296480486416,null,0.0776296480486416,0,null,0.0776296480486416,0.0776296480486416,null,0.0776296480486416,0.0292933813001367,null,0.0292933813001367,0.0292933813001367,null,0.0292933813001367,0,null,0.0292933813001367,0.0292933813001367,null,0.0292933813001367,0.0143880277046852,null,0.0143880277046852,0.0143880277046852,null,0.0143880277046852,0,null,0.0143880277046852,0.0143880277046852,null,0.0143880277046852,0,null,0.151073643578534,0.151073643578534,null,0.151073643578534,0],"text":["y: 0.24331044","y: 0.24331044",null,"y: 0.24331044","y: 0.24331044",null,"y: 0.15107364","y: 0.15107364",null,"y: 0.15107364","y: 0.15107364",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.15107364","y: 0.15107364",null,"y: 0.15107364","y: 0.15107364"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.421875,1,null,1,1],"y":[0.243310438709443,0.243310438709443,null,0.243310438709443,0],"text":"y: 0.24331044","type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.421875,1,5.84375,3.6875,2.5,2,3,4.875,4,5.75,5,6.5,6,7,8],"y":[0.243310438709443,0,0.151073643578534,0.0901647789928727,0.0457867257664635,0,0,0.0776296480486416,0,0.0292933813001367,0,0.0143880277046852,0,0,0],"text":["y: 0.24331044","y: 0.00000000","y: 0.15107364","y: 0.09016478","y: 0.04578673","y: 0.00000000","y: 0.00000000","y: 0.07762965","y: 0.00000000","y: 0.02929338","y: 0.00000000","y: 0.01438803","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.802884563141216,0.603119710472576,0.400617483572002,0.513761494943289,0.427237918709659,0.372665373627317,0],[0.802884563141216,1,0.896571780711607,0.734798651121845,0.893310929495436,0.857141069815645,0.815036309912636,0.579517089905847],[0.603119710472576,0.896571780711607,1,0.886113940226527,0.883980814974365,0.843592510599344,0.798854522499623,0.687952190744771],[0.400617483572002,0.734798651121845,0.886113940226527,1,0.755861812685169,0.735683851355138,0.733484488035609,0.736677434875013],[0.513761494943289,0.893310929495436,0.883980814974365,0.755861812685169,1,0.977510617944485,0.962303570989275,0.833157046520831],[0.427237918709659,0.857141069815645,0.843592510599344,0.735683851355138,0.977510617944485,1,0.968608693229564,0.862139653077392],[0.372665373627317,0.815036309912636,0.798854522499623,0.733484488035609,0.962303570989275,0.968608693229564,1,0.885982514714584],[0,0.579517089905847,0.687952190744771,0.736677434875013,0.833157046520831,0.862139653077392,0.885982514714584,1]],"text":[["row: F_HF<br>column: F_HF<br>value: 1.0000","row: F_HF<br>column: B_HM<br>value: 0.9709","row: F_HF<br>column: A_HF<br>value: 0.9415","row: F_HF<br>column: E_HM<br>value: 0.9116","row: F_HF<br>column: G_CM<br>value: 0.9283","row: F_HF<br>column: D_CF<br>value: 0.9156","row: F_HF<br>column: H_CF<br>value: 0.9075","row: F_HF<br>column: C_CM<br>value: 0.8526"],["row: B_HM<br>column: F_HF<br>value: 0.9709","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: A_HF<br>value: 0.9848","row: B_HM<br>column: E_HM<br>value: 0.9609","row: B_HM<br>column: G_CM<br>value: 0.9843","row: B_HM<br>column: D_CF<br>value: 0.9789","row: B_HM<br>column: H_CF<br>value: 0.9727","row: B_HM<br>column: C_CM<br>value: 0.9380"],["row: A_HF<br>column: F_HF<br>value: 0.9415","row: A_HF<br>column: B_HM<br>value: 0.9848","row: A_HF<br>column: A_HF<br>value: 1.0000","row: A_HF<br>column: E_HM<br>value: 0.9832","row: A_HF<br>column: G_CM<br>value: 0.9829","row: A_HF<br>column: D_CF<br>value: 0.9769","row: A_HF<br>column: H_CF<br>value: 0.9704","row: A_HF<br>column: C_CM<br>value: 0.9540"],["row: E_HM<br>column: F_HF<br>value: 0.9116","row: E_HM<br>column: B_HM<br>value: 0.9609","row: E_HM<br>column: A_HF<br>value: 0.9832","row: E_HM<br>column: E_HM<br>value: 1.0000","row: E_HM<br>column: G_CM<br>value: 0.9640","row: E_HM<br>column: D_CF<br>value: 0.9610","row: E_HM<br>column: H_CF<br>value: 0.9607","row: E_HM<br>column: C_CM<br>value: 0.9612"],["row: G_CM<br>column: F_HF<br>value: 0.9283","row: G_CM<br>column: B_HM<br>value: 0.9843","row: G_CM<br>column: A_HF<br>value: 0.9829","row: G_CM<br>column: E_HM<br>value: 0.9640","row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: D_CF<br>value: 0.9967","row: G_CM<br>column: H_CF<br>value: 0.9944","row: G_CM<br>column: C_CM<br>value: 0.9754"],["row: D_CF<br>column: F_HF<br>value: 0.9156","row: D_CF<br>column: B_HM<br>value: 0.9789","row: D_CF<br>column: A_HF<br>value: 0.9769","row: D_CF<br>column: E_HM<br>value: 0.9610","row: D_CF<br>column: G_CM<br>value: 0.9967","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: H_CF<br>value: 0.9954","row: D_CF<br>column: C_CM<br>value: 0.9797"],["row: H_CF<br>column: F_HF<br>value: 0.9075","row: H_CF<br>column: B_HM<br>value: 0.9727","row: H_CF<br>column: A_HF<br>value: 0.9704","row: H_CF<br>column: E_HM<br>value: 0.9607","row: H_CF<br>column: G_CM<br>value: 0.9944","row: H_CF<br>column: D_CF<br>value: 0.9954","row: H_CF<br>column: H_CF<br>value: 1.0000","row: H_CF<br>column: C_CM<br>value: 0.9832"],["row: C_CM<br>column: F_HF<br>value: 0.8526","row: C_CM<br>column: B_HM<br>value: 0.9380","row: C_CM<br>column: A_HF<br>value: 0.9540","row: C_CM<br>column: E_HM<br>value: 0.9612","row: C_CM<br>column: G_CM<br>value: 0.9754","row: C_CM<br>column: D_CF<br>value: 0.9797","row: C_CM<br>column: H_CF<br>value: 0.9832","row: C_CM<br>column: C_CM<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.372665373627317,"#2C718E"],[0.400617483572002,"#2A788E"],[0.427237918709659,"#277F8E"],[0.513761494943289,"#20938C"],[0.579517089905847,"#20A386"],[0.603119710472576,"#23A983"],[0.687952190744771,"#3EBC74"],[0.733484488035609,"#54C568"],[0.734798651121845,"#55C568"],[0.735683851355138,"#55C667"],[0.736677434875013,"#56C667"],[0.755861812685169,"#5FCA61"],[0.798854522499623,"#79D152"],[0.802884563141216,"#7BD250"],[0.815036309912636,"#84D44B"],[0.833157046520831,"#8FD644"],[0.843592510599344,"#95D840"],[0.857141069815645,"#9FDA3A"],[0.862139653077392,"#A2DA37"],[0.883980814974365,"#B1DD2E"],[0.885982514714584,"#B2DD2D"],[0.886113940226527,"#B2DD2D"],[0.893310929495436,"#B7DE29"],[0.896571780711607,"#B9DE28"],[0.962303570989275,"#E6E419"],[0.968608693229564,"#EAE51A"],[0.977510617944485,"#F0E51C"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_120aaee5c8a823b7c7f3aa300bb46190","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#481467"],[0.0714285714285715,"#472A7A"],[0.142857142857143,"#423F85"],[0.214285714285714,"#3A538B"],[0.285714285714286,"#32658E"],[0.357142857142857,"#2B758E"],[0.428571428571428,"#24868E"],[0.5,"#1F968B"],[0.571428571428571,"#21A685"],[0.642857142857143,"#33B679"],[0.714285714285714,"#52C569"],[0.785714285714286,"#77D153"],[0.857142857142857,"#A3DA37"],[0.928571428571428,"#D1E21B"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.90","0.95","1.00"],"tickvals":[0.285714285714287,0.642857142857143,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.243310438709443,0.243310438709443,null,0.243310438709443,0.151073643578534,null,0.151073643578534,0.151073643578534,null,0.151073643578534,0.0901647789928727,null,0.0901647789928727,0.0901647789928727,null,0.0901647789928727,0.0457867257664635,null,0.0457867257664635,0.0457867257664635,null,0.0457867257664635,0,null,0.0457867257664635,0.0457867257664635,null,0.0457867257664635,0,null,0.0901647789928727,0.0901647789928727,null,0.0901647789928727,0.0776296480486416,null,0.0776296480486416,0.0776296480486416,null,0.0776296480486416,0,null,0.0776296480486416,0.0776296480486416,null,0.0776296480486416,0.0292933813001367,null,0.0292933813001367,0.0292933813001367,null,0.0292933813001367,0,null,0.0292933813001367,0.0292933813001367,null,0.0292933813001367,0.0143880277046852,null,0.0143880277046852,0.0143880277046852,null,0.0143880277046852,0,null,0.0143880277046852,0.0143880277046852,null,0.0143880277046852,0,null,0.151073643578534,0.151073643578534,null,0.151073643578534,0],"y":[3.421875,5.84375,null,5.84375,5.84375,null,5.84375,3.6875,null,3.6875,3.6875,null,3.6875,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.6875,4.875,null,4.875,4.875,null,4.875,4,null,4,4,null,4.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,5.84375,8,null,8,8],"text":["y: 0.24331044","y: 0.24331044",null,"y: 0.24331044","y: 0.24331044",null,"y: 0.15107364","y: 0.15107364",null,"y: 0.15107364","y: 0.15107364",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.04578673","y: 0.04578673",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.09016478","y: 0.09016478",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.07762965","y: 0.07762965",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.02929338","y: 0.02929338",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.01438803","y: 0.01438803",null,"y: 0.15107364","y: 0.15107364",null,"y: 0.15107364","y: 0.15107364"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.243310438709443,0.243310438709443,null,0.243310438709443,0],"y":[3.421875,1,null,1,1],"text":"y: 0.24331044","type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.243310438709443,0,0.151073643578534,0.0901647789928727,0.0457867257664635,0,0,0.0776296480486416,0,0.0292933813001367,0,0.0143880277046852,0,0,0],"y":[3.421875,1,5.84375,3.6875,2.5,2,3,4.875,4,5.75,5,6.5,6,7,8],"text":["y: 0.24331044","y: 0.00000000","y: 0.15107364","y: 0.09016478","y: 0.04578673","y: 0.00000000","y: 0.00000000","y: 0.07762965","y: 0.00000000","y: 0.02929338","y: 0.00000000","y: 0.01438803","y: 0.00000000","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["F_HF","B_HM","A_HF","E_HM","G_CM","D_CF","H_CF","C_CM"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.243310438709443],"ticktext":["0.00","0.05","0.10","0.15","0.20"],"tickvals":[0,0.05,0.1,0.15,0.2],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["F_HF","B_HM","A_HF","E_HM","G_CM","D_CF","H_CF","C_CM"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.243310438709443],"ticktext":["0.00","0.05","0.10","0.15","0.20"],"tickvals":[0,0.05,0.1,0.15,0.2],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Pearson Correlation @ 10kb"},"attrs":{"e21a2d4a30b":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a561c28a0":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a1324b8a9":{"alpha":1,"sizes":[10,100]},"e21a461ca0d5":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a70fd82f7":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a13a16015":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>heatmaply(corheats, main=&quot;Pairwise Spearman Correlation @ 10kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)) #Clusters excellently!</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="e21a5e4e9b8d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="e21a5e4e9b8d">{"x":{"data":[{"x":[4.6875,6.875,null,6.875,6.875,null,6.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,6.875,8,null,8,8],"y":[0.801328353817721,0.801328353817721,null,0.801328353817721,0.440369991478102,null,0.440369991478102,0.440369991478102,null,0.440369991478102,0.373384942971142,null,0.373384942971142,0.373384942971142,null,0.373384942971142,0,null,0.373384942971142,0.373384942971142,null,0.373384942971142,0.320828431472069,null,0.320828431472069,0.320828431472069,null,0.320828431472069,0,null,0.320828431472069,0.320828431472069,null,0.320828431472069,0,null,0.440369991478102,0.440369991478102,null,0.440369991478102,0],"text":["y: 0.8013284","y: 0.8013284",null,"y: 0.8013284","y: 0.8013284",null,"y: 0.4403700","y: 0.4403700",null,"y: 0.4403700","y: 0.4403700",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.4403700","y: 0.4403700",null,"y: 0.4403700","y: 0.4403700"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.6875,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[0.801328353817721,0.801328353817721,null,0.801328353817721,0.347805461634337,null,0.347805461634337,0.347805461634337,null,0.347805461634337,0.184967692766728,null,0.184967692766728,0.184967692766728,null,0.184967692766728,0,null,0.184967692766728,0.184967692766728,null,0.184967692766728,0,null,0.347805461634337,0.347805461634337,null,0.347805461634337,0.182582253365049,null,0.182582253365049,0.182582253365049,null,0.182582253365049,0,null,0.182582253365049,0.182582253365049,null,0.182582253365049,0],"text":["y: 0.8013284","y: 0.8013284",null,"y: 0.8013284","y: 0.8013284",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.1825823","y: 0.1825823",null,"y: 0.1825823","y: 0.1825823",null,"y: 0.1825823","y: 0.1825823",null,"y: 0.1825823","y: 0.1825823"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.6875,2.5,1.5,1,2,3.5,3,4,6.875,5.75,5,6.5,6,7,8],"y":[0.801328353817721,0.347805461634337,0.184967692766728,0,0,0.182582253365049,0,0,0.440369991478102,0.373384942971142,0,0.320828431472069,0,0,0],"text":["y: 0.8013284","y: 0.3478055","y: 0.1849677","y: 0.0000000","y: 0.0000000","y: 0.1825823","y: 0.0000000","y: 0.0000000","y: 0.4403700","y: 0.3733849","y: 0.0000000","y: 0.3208284","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.730784656327005,0.728995128838866,0.637333234448528,0.210644200524634,0.064650477136336,0.182023781822974,0],[0.730784656327005,1,0.751178731829319,0.685299557473808,0.160307822039386,0.0806227643399983,0.196862697580726,0.0809277824681169],[0.728995128838866,0.751178731829319,1,0.753591001010405,0.361968346869308,0.267816859582567,0.381206479611999,0.244995051199919],[0.637333234448528,0.685299557473808,0.753591001010405,1,0.388773914789546,0.317339909779092,0.450157555404422,0.350691575606694],[0.210644200524634,0.160307822039386,0.361968346869308,0.388773914789546,1,0.453735022630178,0.504554594236688,0.360077208138704],[0.064650477136336,0.0806227643399983,0.267816859582567,0.317339909779092,0.453735022630178,1,0.553831477382305,0.371879462676424],[0.182023781822974,0.196862697580726,0.381206479611999,0.450157555404422,0.504554594236688,0.553831477382305,1,0.493350572174402],[0,0.0809277824681169,0.244995051199919,0.350691575606694,0.360077208138704,0.371879462676424,0.493350572174402,1]],"text":[["row: G_CM<br>column: G_CM<br>value: 1.0000","row: G_CM<br>column: C_CM<br>value: 0.8744","row: G_CM<br>column: H_CF<br>value: 0.8736","row: G_CM<br>column: D_CF<br>value: 0.8309","row: G_CM<br>column: B_HM<br>value: 0.6319","row: G_CM<br>column: E_HM<br>value: 0.5638","row: G_CM<br>column: F_HF<br>value: 0.6185","row: G_CM<br>column: A_HF<br>value: 0.5336"],["row: C_CM<br>column: G_CM<br>value: 0.8744","row: C_CM<br>column: C_CM<br>value: 1.0000","row: C_CM<br>column: H_CF<br>value: 0.8840","row: C_CM<br>column: D_CF<br>value: 0.8532","row: C_CM<br>column: B_HM<br>value: 0.6084","row: C_CM<br>column: E_HM<br>value: 0.5712","row: C_CM<br>column: F_HF<br>value: 0.6254","row: C_CM<br>column: A_HF<br>value: 0.5714"],["row: H_CF<br>column: G_CM<br>value: 0.8736","row: H_CF<br>column: C_CM<br>value: 0.8840","row: H_CF<br>column: H_CF<br>value: 1.0000","row: H_CF<br>column: D_CF<br>value: 0.8851","row: H_CF<br>column: B_HM<br>value: 0.7024","row: H_CF<br>column: E_HM<br>value: 0.6585","row: H_CF<br>column: F_HF<br>value: 0.7114","row: H_CF<br>column: A_HF<br>value: 0.6479"],["row: D_CF<br>column: G_CM<br>value: 0.8309","row: D_CF<br>column: C_CM<br>value: 0.8532","row: D_CF<br>column: H_CF<br>value: 0.8851","row: D_CF<br>column: D_CF<br>value: 1.0000","row: D_CF<br>column: B_HM<br>value: 0.7149","row: D_CF<br>column: E_HM<br>value: 0.6816","row: D_CF<br>column: F_HF<br>value: 0.7436","row: D_CF<br>column: A_HF<br>value: 0.6972"],["row: B_HM<br>column: G_CM<br>value: 0.6319","row: B_HM<br>column: C_CM<br>value: 0.6084","row: B_HM<br>column: H_CF<br>value: 0.7024","row: B_HM<br>column: D_CF<br>value: 0.7149","row: B_HM<br>column: B_HM<br>value: 1.0000","row: B_HM<br>column: E_HM<br>value: 0.7452","row: B_HM<br>column: F_HF<br>value: 0.7689","row: B_HM<br>column: A_HF<br>value: 0.7016"],["row: E_HM<br>column: G_CM<br>value: 0.5638","row: E_HM<br>column: C_CM<br>value: 0.5712","row: E_HM<br>column: H_CF<br>value: 0.6585","row: E_HM<br>column: D_CF<br>value: 0.6816","row: E_HM<br>column: B_HM<br>value: 0.7452","row: E_HM<br>column: E_HM<br>value: 1.0000","row: E_HM<br>column: F_HF<br>value: 0.7919","row: E_HM<br>column: A_HF<br>value: 0.7071"],["row: F_HF<br>column: G_CM<br>value: 0.6185","row: F_HF<br>column: C_CM<br>value: 0.6254","row: F_HF<br>column: H_CF<br>value: 0.7114","row: F_HF<br>column: D_CF<br>value: 0.7436","row: F_HF<br>column: B_HM<br>value: 0.7689","row: F_HF<br>column: E_HM<br>value: 0.7919","row: F_HF<br>column: F_HF<br>value: 1.0000","row: F_HF<br>column: A_HF<br>value: 0.7637"],["row: A_HF<br>column: G_CM<br>value: 0.5336","row: A_HF<br>column: C_CM<br>value: 0.5714","row: A_HF<br>column: H_CF<br>value: 0.6479","row: A_HF<br>column: D_CF<br>value: 0.6972","row: A_HF<br>column: B_HM<br>value: 0.7016","row: A_HF<br>column: E_HM<br>value: 0.7071","row: A_HF<br>column: F_HF<br>value: 0.7637","row: A_HF<br>column: A_HF<br>value: 1.0000"]],"colorscale":[[0,"#440154"],[0.064650477136336,"#48196B"],[0.0806227643399983,"#481E70"],[0.0809277824681169,"#481E70"],[0.160307822039386,"#453882"],[0.182023781822974,"#433E85"],[0.196862697580726,"#414287"],[0.210644200524634,"#3F4788"],[0.244995051199919,"#3C508B"],[0.267816859582567,"#39578C"],[0.317339909779092,"#32648E"],[0.350691575606694,"#2F6C8E"],[0.360077208138704,"#2E6F8E"],[0.361968346869308,"#2E6F8E"],[0.371879462676424,"#2C718E"],[0.381206479611999,"#2C738E"],[0.388773914789546,"#2B758E"],[0.450157555404422,"#25848E"],[0.453735022630178,"#25858E"],[0.493350572174402,"#218F8D"],[0.504554594236688,"#20928C"],[0.553831477382305,"#1E9D89"],[0.637333234448528,"#2BB17E"],[0.685299557473808,"#3DBC74"],[0.728995128838866,"#52C569"],[0.730784656327005,"#53C569"],[0.751178731829319,"#5DC962"],[0.753591001010405,"#5EC962"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_8ff1d88fd83032ef7804b0317e168ca9","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#450659"],[0.0434782608695653,"#481668"],[0.0869565217391305,"#482475"],[0.130434782608696,"#46327E"],[0.173913043478261,"#423F85"],[0.217391304347826,"#3E4C8A"],[0.260869565217391,"#38588C"],[0.304347826086957,"#33638D"],[0.347826086956522,"#2E6E8E"],[0.391304347826087,"#2A788E"],[0.434782608695652,"#26828E"],[0.478260869565217,"#228D8D"],[0.521739130434783,"#1F978B"],[0.565217391304348,"#1FA187"],[0.608695652173913,"#25AC82"],[0.652173913043478,"#32B67A"],[0.695652173913044,"#43BE71"],[0.739130434782609,"#59C765"],[0.782608695652174,"#71CF57"],[0.826086956521739,"#8CD646"],[0.869565217391304,"#A8DB34"],[0.91304347826087,"#C5E021"],[0.956521739130435,"#E2E418"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.6","0.7","0.8","0.9","1.0"],"tickvals":[0.130434782608696,0.347826086956522,0.565217391304348,0.782608695652174,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.801328353817721,0.801328353817721,null,0.801328353817721,0.440369991478102,null,0.440369991478102,0.440369991478102,null,0.440369991478102,0.373384942971142,null,0.373384942971142,0.373384942971142,null,0.373384942971142,0,null,0.373384942971142,0.373384942971142,null,0.373384942971142,0.320828431472069,null,0.320828431472069,0.320828431472069,null,0.320828431472069,0,null,0.320828431472069,0.320828431472069,null,0.320828431472069,0,null,0.440369991478102,0.440369991478102,null,0.440369991478102,0],"y":[4.6875,6.875,null,6.875,6.875,null,6.875,5.75,null,5.75,5.75,null,5.75,5,null,5,5,null,5.75,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,6.875,8,null,8,8],"text":["y: 0.8013284","y: 0.8013284",null,"y: 0.8013284","y: 0.8013284",null,"y: 0.4403700","y: 0.4403700",null,"y: 0.4403700","y: 0.4403700",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3733849","y: 0.3733849",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.3208284","y: 0.3208284",null,"y: 0.4403700","y: 0.4403700",null,"y: 0.4403700","y: 0.4403700"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.801328353817721,0.801328353817721,null,0.801328353817721,0.347805461634337,null,0.347805461634337,0.347805461634337,null,0.347805461634337,0.184967692766728,null,0.184967692766728,0.184967692766728,null,0.184967692766728,0,null,0.184967692766728,0.184967692766728,null,0.184967692766728,0,null,0.347805461634337,0.347805461634337,null,0.347805461634337,0.182582253365049,null,0.182582253365049,0.182582253365049,null,0.182582253365049,0,null,0.182582253365049,0.182582253365049,null,0.182582253365049,0],"y":[4.6875,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"text":["y: 0.8013284","y: 0.8013284",null,"y: 0.8013284","y: 0.8013284",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.1849677","y: 0.1849677",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.3478055","y: 0.3478055",null,"y: 0.1825823","y: 0.1825823",null,"y: 0.1825823","y: 0.1825823",null,"y: 0.1825823","y: 0.1825823",null,"y: 0.1825823","y: 0.1825823"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.801328353817721,0.347805461634337,0.184967692766728,0,0,0.182582253365049,0,0,0.440369991478102,0.373384942971142,0,0.320828431472069,0,0,0],"y":[4.6875,2.5,1.5,1,2,3.5,3,4,6.875,5.75,5,6.5,6,7,8],"text":["y: 0.8013284","y: 0.3478055","y: 0.1849677","y: 0.0000000","y: 0.0000000","y: 0.1825823","y: 0.0000000","y: 0.0000000","y: 0.4403700","y: 0.3733849","y: 0.0000000","y: 0.3208284","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["G_CM","C_CM","H_CF","D_CF","B_HM","E_HM","F_HF","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.801328353817721],"ticktext":["0.0","0.2","0.4","0.6","0.8"],"tickvals":[0,0.2,0.4,0.6,0.8],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["G_CM","C_CM","H_CF","D_CF","B_HM","E_HM","F_HF","A_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.801328353817721],"ticktext":["0.0","0.2","0.4","0.6","0.8"],"tickvals":[0,0.2,0.4,0.6,0.8],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Spearman Correlation @ 10kb"},"attrs":{"e21a77ba5bb2":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a6bda4086":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"e21a190a5018":{"alpha":1,"sizes":[10,100]},"e21a6a4f6c2a":{"fill":{},"text":{},"x":{},"y":{},"type":"ggplotly"},"e21a588e1250":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"e21a57546f9b":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>#FOR VC as well, after filtering, Spearman holds up perfectly, Pearson has slight issues (dendrogram isn&#39;t right although larger groups clustered properly)


###PCA:
pca &lt;- prcomp(t(filt.KR[,112:119]), scale=TRUE, center=TRUE)
pca2 &lt;- prcomp(t(filt.VC[,112:119]), scale=TRUE, center=TRUE)
ggplot(data=as.data.frame(pca$x), aes(x=PC1, y=PC2, shape=as.factor(meta.data$SP), color=as.factor(meta.data$Batch), size=2)) + geom_point() +labs(title=&quot;PCA on KR normalized Hi-C Contact Frequency&quot;) + guides(color=guide_legend(order=1), size=FALSE, shape=guide_legend(order=2)) + xlab(paste(&quot;PC1 (&quot;, 100*summary(pca)$importance[2,1], &quot;% of variance)&quot;)) + ylab((paste(&quot;PC2 (&quot;, 100*summary(pca)$importance[2,2], &quot;% of variance)&quot;))) + labs(color=&quot;Batch&quot;, shape=&quot;Species&quot;) + scale_shape_manual(labels=c(&quot;Chimp&quot;, &quot;Human&quot;), values=c(16, 17))</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-13.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(summary(pca)$importance[2,], xlab=&quot;PCs&quot;, ylab=&quot;Proportion of Variance Explained&quot;, main=&quot;PCA on KR normalized Hi-C contact frequency&quot;) #Scree plot showing all the PCs and the proportion of the variance they explain.</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-14.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggplot(data=as.data.frame(pca2$x), aes(x=PC1, y=PC2, shape=as.factor(meta.data$SP), color=as.factor(meta.data$Batch), size=2)) + geom_point() +labs(title=&quot;PCA on VC normalized Hi-C Contact Frequency&quot;) + guides(color=guide_legend(order=1), size=FALSE, shape=guide_legend(order=2)) + xlab(paste(&quot;PC1 (&quot;, 100*summary(pca)$importance[2,1], &quot;% of variance)&quot;)) + ylab((paste(&quot;PC2 (&quot;, 100*summary(pca)$importance[2,2], &quot;% of variance)&quot;))) + labs(color=&quot;Batch&quot;, shape=&quot;Species&quot;) + scale_shape_manual(labels=c(&quot;Chimp&quot;, &quot;Human&quot;), values=c(16, 17))</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-15.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(summary(pca2)$importance[2,], xlab=&quot;PCs&quot;, ylab=&quot;Proportion of Variance Explained&quot;, main=&quot;PCA on VC normalized Hi-C contact frequency&quot;)</code></pre>
<p><img src="figure/juicer_initial_QC.Rmd/Variance%20QC-16.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Scree plot

#Ok, well nice to know. Now to write out files.

fwrite(filt.KR, &quot;~/Desktop/Hi-C/juicer.filt.KR&quot;, quote = TRUE, sep = &quot;\t&quot;, row.names = FALSE, col.names = TRUE, na=&quot;NA&quot;, showProgress = FALSE)
fwrite(filt.VC, &quot;~/Desktop/Hi-C/juicer.filt.VC&quot;, quote=TRUE, sep=&quot;\t&quot;, row.names=FALSE, col.names=TRUE, na=&quot;NA&quot;, showProgress=FALSE)</code></pre>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.4.0 (2017-04-21)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: OS X El Capitan 10.11.6

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] compiler  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] bindrcpp_0.2        bedr_1.0.4          forcats_0.3.0      
 [4] purrr_0.2.4         readr_1.1.1         tibble_1.4.2       
 [7] tidyverse_1.2.1     edgeR_3.20.9        RColorBrewer_1.1-2 
[10] heatmaply_0.14.1    viridis_0.5.0       viridisLite_0.3.0  
[13] stringr_1.3.0       gplots_3.0.1        Hmisc_4.1-1        
[16] Formula_1.2-2       survival_2.41-3     lattice_0.20-35    
[19] dplyr_0.7.4         plotly_4.7.1        ggplot2_2.2.1      
[22] reshape2_1.4.3      data.table_1.10.4-3 tidyr_0.8.0        
[25] plyr_1.8.4          limma_3.34.9       

loaded via a namespace (and not attached):
  [1] colorspace_1.3-2     class_7.3-14         modeltools_0.2-21   
  [4] mclust_5.4           rprojroot_1.3-2      htmlTable_1.11.2    
  [7] futile.logger_1.4.3  base64enc_0.1-3      rstudioapi_0.7      
 [10] flexmix_2.3-14       mvtnorm_1.0-7        lubridate_1.7.3     
 [13] xml2_1.2.0           codetools_0.2-15     splines_3.4.0       
 [16] R.methodsS3_1.7.1    mnormt_1.5-5         robustbase_0.92-8   
 [19] knitr_1.20           jsonlite_1.5         broom_0.4.3         
 [22] cluster_2.0.6        kernlab_0.9-25       R.oo_1.21.0         
 [25] shiny_1.0.5          httr_1.3.1           backports_1.1.2     
 [28] assertthat_0.2.0     Matrix_1.2-12        lazyeval_0.2.1      
 [31] cli_1.0.0            acepack_1.4.1        htmltools_0.3.6     
 [34] tools_3.4.0          gtable_0.2.0         glue_1.2.0          
 [37] Rcpp_0.12.16         cellranger_1.1.0     trimcluster_0.1-2   
 [40] gdata_2.18.0         nlme_3.1-131.1       crosstalk_1.0.0     
 [43] iterators_1.0.9      fpc_2.1-11           psych_1.7.8         
 [46] testthat_2.0.0       rvest_0.3.2          mime_0.5            
 [49] gtools_3.5.0         dendextend_1.7.0     DEoptimR_1.0-8      
 [52] MASS_7.3-49          scales_0.5.0         TSP_1.1-5           
 [55] hms_0.4.2            parallel_3.4.0       lambda.r_1.2        
 [58] yaml_2.1.18          gridExtra_2.3        rpart_4.1-13        
 [61] latticeExtra_0.6-28  stringi_1.1.7        gclus_1.3.1         
 [64] foreach_1.4.4        checkmate_1.8.5      seriation_1.2-3     
 [67] caTools_1.17.1       rlang_0.2.0          pkgconfig_2.0.1     
 [70] prabclus_2.2-6       bitops_1.0-6         evaluate_0.10.1     
 [73] bindr_0.1.1          labeling_0.3         htmlwidgets_1.0     
 [76] magrittr_1.5         R6_2.2.2             pillar_1.2.1        
 [79] haven_1.1.1          whisker_0.3-2        foreign_0.8-69      
 [82] nnet_7.3-12          modelr_0.1.1         crayon_1.3.4        
 [85] futile.options_1.0.0 KernSmooth_2.23-15   rmarkdown_1.9       
 [88] locfit_1.5-9.1       grid_3.4.0           readxl_1.0.0        
 [91] git2r_0.21.0         digest_0.6.15        diptest_0.75-7      
 [94] webshot_0.5.0        xtable_1.8-2         VennDiagram_1.6.19  
 [97] httpuv_1.3.6.2       R.utils_2.6.0        stats4_3.4.0        
[100] munsell_0.4.3        registry_0.5        </code></pre>
<pre class="r"><code>###No longer used, just notes about the normalization scheme.
#full.contacts2 &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.25, iterations=3, method=&quot;pairs&quot;)) #Good Spearman, poor Pearson (not even proper clustering)
#full.contacts3 &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.29, iterations=3, method=&quot;pairs&quot;)) #Both terrible!
#full.contacts4 &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.39, iterations=3, method=&quot;pairs&quot;)) #Spearman clusters properly but correlation values not great in terms of separation; Pearson just terrible and doesn&#39;t cluster right.
#full.contacts5 &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.35, iterations=3, method=&quot;pairs&quot;)) #Both TERRIBUL
#full.contacts6 &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.2, iterations=2, method=&quot;pairs&quot;)) #Gives the right clustering but not great correlations on Pearson. Same but a little better with Spearman.
#full.contacts7 &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.3, iterations=1, method=&quot;pairs&quot;)) #Spearman decent but Pearson terrible.
#full.contacts8 &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.333, iterations=5, method=&quot;pairs&quot;)) #Terrible!


#Normalization schemes
#KR.1 &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=0.17, iterations=3, method=&quot;pairs&quot;))
#KR.2 &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=0.31, iterations=2, method=&quot;pairs&quot;))
#VC.contacts &lt;- as.data.frame(normalizeCyclicLoess(VC.contacts, span=0.31, iterations=3, method=&quot;pairs&quot;))

# Kfull.contacts2 &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=1/4, iterations=3, method=&quot;pairs&quot;)) #Awful Pearson, slightly worse than above Spearman.
# Kfull.contacts3 &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=0.29, iterations=3, method=&quot;pairs&quot;)) #Terrible Pearson, middling Spearman.
# Kfull.contacts6 &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=0.3, iterations=1, method=&quot;pairs&quot;)) #Terrible Pearson, solid Spearman.
# Kfull.contacts7 &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=0.5, iterations=2, method=&quot;pairs&quot;))
# 
# for(myspan in seq(0.2, 0.25, 0.01)){
#   iteration &lt;- 2
#     Kcontacts &lt;- as.data.frame(normalizeCyclicLoess(KR.contacts, span=myspan, iterations=iteration, method=&quot;pairs&quot;))
#     corheat &lt;- cor(Kcontacts, use=&quot;complete.obs&quot;, method=&quot;pearson&quot;)
#     corheats &lt;- cor(Kcontacts, use=&quot;complete.obs&quot;, method=&quot;spearman&quot;)
#     colnames(corheat) &lt;- c(&quot;A_HF&quot;, &quot;B_HM&quot;, &quot;C_CM&quot;, &quot;D_CF&quot;, &quot;E_HM&quot;, &quot;F_HF&quot;, &quot;G_CM&quot;, &quot;H_CF&quot;)
#     rownames(corheat) &lt;- colnames(corheat)
#     colnames(corheats) &lt;- colnames(corheat)
#     rownames(corheats) &lt;- colnames(corheat)
#     print(heatmaply(corheat, main=paste(&quot;Pearson, 10kb, &quot;, myspan, &quot; span, &quot;, iteration, &quot; iterations.&quot;, sep=&quot;&quot;), k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)))
#     print(heatmaply(corheats, main=paste(&quot;Spearman, 10kb, &quot;, myspan, &quot; span, &quot;, iteration, &quot; iterations.&quot;, sep=&quot;&quot;), k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30)))
# }</code></pre>
</div>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Eres, Ittai" />

<meta name="date" content="2017-10-06" />

<title>initial_QC</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.7.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.27.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.27.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Hi-C</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jdblischak/workflowr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">initial_QC</h1>
<h4 class="author"><em>Eres, Ittai</em></h4>
<h4 class="date"><em>2017-10-06</em></h4>

</div>


<!-- The file analysis/chunks.R contains chunks that define default settings
shared across the workflowr files. -->
<!-- Update knitr chunk options -->
<!-- Insert the date the file was last updated -->
<p><strong>Last updated:</strong> 2017-10-10</p>
<!-- Insert the code version (Git commit SHA1) if Git repository exists and R
 package git2r is installed -->
<p><strong>Code version:</strong> f955603</p>
<!-- Add your analysis here -->
<pre class="r"><code>#Load in necessary packages
library(limma)</code></pre>
<pre><code>Warning: package &#39;limma&#39; was built under R version 3.4.1</code></pre>
<pre class="r"><code>library(plyr)
library(tidyr)
library(data.table)
library(reshape2)</code></pre>
<pre><code>
Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:data.table&#39;:

    dcast, melt</code></pre>
<pre><code>The following object is masked from &#39;package:tidyr&#39;:

    smiths</code></pre>
<pre class="r"><code>library(ggplot2)
library(plotly)</code></pre>
<pre><code>
Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:ggplot2&#39;:

    last_plot</code></pre>
<pre><code>The following objects are masked from &#39;package:plyr&#39;:

    arrange, mutate, rename, summarise</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    filter</code></pre>
<pre><code>The following object is masked from &#39;package:graphics&#39;:

    layout</code></pre>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>Warning: package &#39;dplyr&#39; was built under R version 3.4.1</code></pre>
<pre><code>
Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:data.table&#39;:

    between, first, last</code></pre>
<pre><code>The following objects are masked from &#39;package:plyr&#39;:

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize</code></pre>
<pre><code>The following objects are masked from &#39;package:stats&#39;:

    filter, lag</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(Hmisc)</code></pre>
<pre><code>Loading required package: lattice</code></pre>
<pre><code>Loading required package: survival</code></pre>
<pre><code>Loading required package: Formula</code></pre>
<pre><code>
Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:dplyr&#39;:

    combine, src, summarize</code></pre>
<pre><code>The following object is masked from &#39;package:plotly&#39;:

    subplot</code></pre>
<pre><code>The following objects are masked from &#39;package:plyr&#39;:

    is.discrete, summarize</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    format.pval, round.POSIXt, trunc.POSIXt, units</code></pre>
<pre class="r"><code>library(gplots)</code></pre>
<pre><code>
Attaching package: &#39;gplots&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:stats&#39;:

    lowess</code></pre>
<pre class="r"><code>library(stringr)
library(heatmaply)</code></pre>
<pre><code>Loading required package: viridis</code></pre>
<pre><code>Loading required package: viridisLite</code></pre>
<pre><code>
---------------------
Welcome to heatmaply version 0.10.1
Type ?heatmaply for the main documentation.
The github page is: https://github.com/talgalili/heatmaply/

Suggestions and bug-reports can be submitted at: https://github.com/talgalili/heatmaply/issues
Or contact: &lt;tal.galili@gmail.com&gt;

    To suppress this message use:  suppressPackageStartupMessages(library(heatmaply))
---------------------</code></pre>
<pre class="r"><code>library(RColorBrewer)
library(edgeR)
library(tidyverse)</code></pre>
<pre><code>Loading tidyverse: tibble
Loading tidyverse: readr
Loading tidyverse: purrr</code></pre>
<pre><code>Conflicts with tidy packages ----------------------------------------------</code></pre>
<pre><code>arrange():   dplyr, plotly, plyr
between():   dplyr, data.table
combine():   dplyr, Hmisc
compact():   purrr, plyr
count():     dplyr, plyr
failwith():  dplyr, plyr
filter():    dplyr, plotly, stats
first():     dplyr, data.table
id():        dplyr, plyr
lag():       dplyr, stats
last():      dplyr, data.table
mutate():    dplyr, plotly, plyr
rename():    dplyr, plotly, plyr
src():       dplyr, Hmisc
summarise(): dplyr, plotly, plyr
summarize(): dplyr, Hmisc, plyr
transpose(): purrr, data.table</code></pre>
<pre class="r"><code>library(compiler)
library(bedr)</code></pre>
<pre><code>

######################
#### bedr v1.0.3 ####
######################

checking binary availability...
  * Checking path for bedtools... FAIL
  * Checking path for bedops... FAIL
  * Checking path for tabix... FAIL
tests and examples will be skipped on R CMD check if binaries are missing</code></pre>
<pre class="r"><code>enableJIT(3)</code></pre>
<pre><code>[1] 3</code></pre>
<pre class="r"><code>###Read in data, normalize it with cyclic loess (pairwise), clean it from any rows that have missing values.
full.data &lt;- fread(&quot;~/Desktop/final.25kb.homer.df&quot;, header=TRUE, stringsAsFactors = FALSE, data.table=FALSE)</code></pre>
<pre><code>
Read 0.0% of 1548077 rows
Read 4.5% of 1548077 rows
Read 9.0% of 1548077 rows
Read 13.6% of 1548077 rows
Read 18.1% of 1548077 rows
Read 22.0% of 1548077 rows
Read 22.6% of 1548077 rows
Read 27.8% of 1548077 rows
Read 32.3% of 1548077 rows
Read 36.8% of 1548077 rows
Read 37.5% of 1548077 rows
Read 40.7% of 1548077 rows
Read 45.9% of 1548077 rows
Read 50.4% of 1548077 rows
Read 54.9% of 1548077 rows
Read 56.2% of 1548077 rows
Read 60.7% of 1548077 rows
Read 65.2% of 1548077 rows
Read 69.8% of 1548077 rows
Read 74.3% of 1548077 rows
Read 78.8% of 1548077 rows
Read 79.5% of 1548077 rows
Read 84.0% of 1548077 rows
Read 86.6% of 1548077 rows
Read 91.1% of 1548077 rows
Read 96.2% of 1548077 rows
Read 1548077 rows and 327 (of 327) columns from 2.140 GB file in 00:00:42</code></pre>
<pre class="r"><code>full.contacts &lt;- full.data[complete.cases(full.data[,320:327]), 320:327]
full.contacts &lt;- as.data.frame(normalizeCyclicLoess(full.contacts, span=1/4, iterations=3, method=&quot;pairs&quot;))
full.data &lt;- full.data[complete.cases(full.data[,320:327]),]
full.data[,320:327] &lt;- full.contacts

###First, a quick look at histograms of the distributions of the significant Hi-C hits from homer, in both humans and chimps.
hist(full.contacts[,c(1:2, 5:6)]) #Human dist&#39;ns</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist(full.contacts[,c(3:4, 7:8)]) #Chimp dist&#39;ns</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Both sets of distributions look fairly bimodal, with chimps in particular showing a peak around 0.

###As an initial quality control metric, take a look at the mean vs. variance plot for the normalized data:
meansdata &lt;- rowMeans(full.contacts) #Check mean against variance
varsdata &lt;- apply(full.contacts, 1, var)
{plot(meansdata, varsdata, main=&quot;Mean vs. Variance in Homer-corrected contact frequency&quot;, xlab=&quot;Mean Hi-C Contact Frequency&quot;, ylab=&quot;Variance in Hi-C Contact Frequency&quot;)
  abline(lm(meansdata~varsdata), col=&quot;red&quot;)}</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###Now do principal components analysis (PCA) on these data to see how they separate:
meta.data &lt;- data.frame(&quot;SP&quot;=c(&quot;H&quot;, &quot;H&quot;, &quot;C&quot;, &quot;C&quot;, &quot;H&quot;, &quot;H&quot;, &quot;C&quot;, &quot;C&quot;), &quot;SX&quot;=c(&quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;), &quot;Batch&quot;=c(1, 1, 1, 1, 2, 2, 2, 2)) #need the metadata first to make this interesting
pca &lt;- prcomp(t(full.contacts), scale=TRUE, center=TRUE)
ggplot(data=as.data.frame(pca$x), aes(x=PC1, y=PC2, shape=as.factor(meta.data$SP), color=as.factor(meta.data$Batch), size=2)) + geom_point() +labs(title=&quot;PCA on normalized Hi-C Contact Frequency&quot;) + guides(color=guide_legend(order=1), size=FALSE, shape=guide_legend(order=2)) + xlab(paste(&quot;PC1 (&quot;, 100*summary(pca)$importance[2,1], &quot;% of variance)&quot;)) + ylab((paste(&quot;PC2 (&quot;, 100*summary(pca)$importance[2,2], &quot;% of variance)&quot;))) #PCA shows the species separating nicely along PC1, which explains the highest proportion of the variance (as seen from scree plot below). This is nice and suggests that there ARE true differences in the data between species we are likely to detect here.</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(summary(pca)$importance[2,], xlab=&quot;PCs&quot;, ylab=&quot;Proportion of Variance Explained&quot;, main=&quot;PCA on normalized Hi-C contact frequency&quot;) #Scree plot showing all the PCs and the proportion of the variance they explain.</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-5.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###Heatmap clustering of these data as another quality control metric:
corheat &lt;- cor(full.contacts, use=&quot;complete.obs&quot;, method=&quot;pearson&quot;) #Corheat for the full data set, and heatmap
colnames(corheat) &lt;- c(&quot;A_HF&quot;, &quot;B_HM&quot;, &quot;C_CM&quot;, &quot;D_CF&quot;, &quot;E_HM&quot;, &quot;F_HF&quot;, &quot;G_CM&quot;, &quot;H_CF&quot;)
rownames(corheat) &lt;- colnames(corheat)
heatmaply(corheat, main=&quot;Pairwise Pearson Correlation @ 25kb&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30))</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="38fa58db031" style="width:504px;height:360px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa58db031">{"x":{"data":[{"x":[4.5,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"y":[1.14626177219499,1.14626177219499,null,1.14626177219499,1.04675308271078,null,1.04675308271078,1.04675308271078,null,1.04675308271078,1.0290066280827,null,1.0290066280827,1.0290066280827,null,1.0290066280827,1.0035060271696,null,1.0035060271696,1.0035060271696,null,1.0035060271696,0,null,1.0035060271696,1.0035060271696,null,1.0035060271696,0,null,1.0290066280827,1.0290066280827,null,1.0290066280827,0,null,1.04675308271078,1.04675308271078,null,1.04675308271078,0],"text":["y: 1.1462618","y: 1.1462618",null,"y: 1.1462618","y: 1.1462618",null,"y: 1.0467531","y: 1.0467531",null,"y: 1.0467531","y: 1.0467531",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0467531","y: 1.0467531",null,"y: 1.0467531","y: 1.0467531"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.5,1.875,null,1.875,1.875,null,1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[1.14626177219499,1.14626177219499,null,1.14626177219499,0.992197612794563,null,0.992197612794563,0.992197612794563,null,0.992197612794563,0,null,0.992197612794563,0.992197612794563,null,0.992197612794563,0.969932326162913,null,0.969932326162913,0.969932326162913,null,0.969932326162913,0,null,0.969932326162913,0.969932326162913,null,0.969932326162913,0.964890957338606,null,0.964890957338606,0.964890957338606,null,0.964890957338606,0,null,0.964890957338606,0.964890957338606,null,0.964890957338606,0],"text":["y: 1.1462618","y: 1.1462618",null,"y: 1.1462618","y: 1.1462618",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9648910","y: 0.9648910",null,"y: 0.9648910","y: 0.9648910",null,"y: 0.9648910","y: 0.9648910",null,"y: 0.9648910","y: 0.9648910"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.5,1.875,1,2.75,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"y":[1.14626177219499,0.992197612794563,0,0.969932326162913,0,0.964890957338606,0,0,1.04675308271078,1.0290066280827,1.0035060271696,0,0,0,0],"text":["y: 1.1462618","y: 0.9921976","y: 0.0000000","y: 0.9699323","y: 0.0000000","y: 0.9648910","y: 0.0000000","y: 0.0000000","y: 1.0467531","y: 1.0290066","y: 1.0035060","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.131283675361651,0.126231769715298,0.128196179577629,0.0807503529834963,0.0389555614678108,0.0169608779690677,0],[0.131283675361651,1,0.145555484219675,0.148199344917274,0.0860028178241922,0.0394558231014426,0.0197849034040161,0.0191187386442862],[0.126231769715298,0.145555484219675,1,0.150108887777342,0.0755359530955524,0.047550119761339,0.0277030916096895,0.0198768628681361],[0.128196179577629,0.148199344917274,0.150108887777342,1,0.0922866507659413,0.0557805296974625,0.035223899966648,0.0350689328062909],[0.0807503529834963,0.0860028178241922,0.0755359530955524,0.0922866507659413,1,0.11779384017798,0.109963675001581,0.0989967955556741],[0.0389555614678108,0.0394558231014426,0.047550119761339,0.0557805296974625,0.11779384017798,1,0.0939436652336554,0.0787472832021132],[0.0169608779690677,0.0197849034040161,0.0277030916096895,0.035223899966648,0.109963675001581,0.0939436652336554,1,0.0890626702788769],[0,0.0191187386442862,0.0198768628681361,0.0350689328062909,0.0989967955556741,0.0787472832021132,0.0890626702788769,1]],"text":[["value: 1.0000000<br />column: D_CF<br />row: D_CF","value: 0.3027624<br />column: C_CM<br />row: D_CF","value: 0.2987077<br />column: H_CF<br />row: D_CF","value: 0.3002844<br />column: G_CM<br />row: D_CF","value: 0.2622041<br />column: E_HM<br />row: D_CF","value: 0.2286593<br />column: A_HF<br />row: D_CF","value: 0.2110062<br />column: F_HF<br />row: D_CF","value: 0.1973933<br />column: B_HM<br />row: D_CF"],["value: 0.3027624<br />column: D_CF<br />row: C_CM","value: 1.0000000<br />column: C_CM<br />row: C_CM","value: 0.3142171<br />column: H_CF<br />row: C_CM","value: 0.3163391<br />column: G_CM<br />row: C_CM","value: 0.2664197<br />column: E_HM<br />row: C_CM","value: 0.2290608<br />column: A_HF<br />row: C_CM","value: 0.2132728<br />column: F_HF<br />row: C_CM","value: 0.2127381<br />column: B_HM<br />row: C_CM"],["value: 0.2987077<br />column: D_CF<br />row: H_CF","value: 0.3142171<br />column: C_CM<br />row: H_CF","value: 1.0000000<br />column: H_CF<br />row: H_CF","value: 0.3178717<br />column: G_CM<br />row: H_CF","value: 0.2580189<br />column: E_HM<br />row: H_CF","value: 0.2355573<br />column: A_HF<br />row: H_CF","value: 0.2196280<br />column: F_HF<br />row: H_CF","value: 0.2133466<br />column: B_HM<br />row: H_CF"],["value: 0.3002844<br />column: D_CF<br />row: G_CM","value: 0.3163391<br />column: C_CM<br />row: G_CM","value: 0.3178717<br />column: H_CF<br />row: G_CM","value: 1.0000000<br />column: G_CM<br />row: G_CM","value: 0.2714632<br />column: E_HM<br />row: G_CM","value: 0.2421631<br />column: A_HF<br />row: G_CM","value: 0.2256642<br />column: F_HF<br />row: G_CM","value: 0.2255398<br />column: B_HM<br />row: G_CM"],["value: 0.2622041<br />column: D_CF<br />row: E_HM","value: 0.2664197<br />column: C_CM<br />row: E_HM","value: 0.2580189<br />column: H_CF<br />row: E_HM","value: 0.2714632<br />column: G_CM<br />row: E_HM","value: 1.0000000<br />column: E_HM<br />row: E_HM","value: 0.2919354<br />column: A_HF<br />row: E_HM","value: 0.2856509<br />column: F_HF<br />row: E_HM","value: 0.2768488<br />column: B_HM<br />row: E_HM"],["value: 0.2286593<br />column: D_CF<br />row: A_HF","value: 0.2290608<br />column: C_CM<br />row: A_HF","value: 0.2355573<br />column: H_CF<br />row: A_HF","value: 0.2421631<br />column: G_CM<br />row: A_HF","value: 0.2919354<br />column: E_HM<br />row: A_HF","value: 1.0000000<br />column: A_HF<br />row: A_HF","value: 0.2727931<br />column: F_HF<br />row: A_HF","value: 0.2605964<br />column: B_HM<br />row: A_HF"],["value: 0.2110062<br />column: D_CF<br />row: F_HF","value: 0.2132728<br />column: C_CM<br />row: F_HF","value: 0.2196280<br />column: H_CF<br />row: F_HF","value: 0.2256642<br />column: G_CM<br />row: F_HF","value: 0.2856509<br />column: E_HM<br />row: F_HF","value: 0.2727931<br />column: A_HF<br />row: F_HF","value: 1.0000000<br />column: F_HF<br />row: F_HF","value: 0.2688756<br />column: B_HM<br />row: F_HF"],["value: 0.1973933<br />column: D_CF<br />row: B_HM","value: 0.2127381<br />column: C_CM<br />row: B_HM","value: 0.2133466<br />column: H_CF<br />row: B_HM","value: 0.2255398<br />column: G_CM<br />row: B_HM","value: 0.2768488<br />column: E_HM<br />row: B_HM","value: 0.2605964<br />column: A_HF<br />row: B_HM","value: 0.2688756<br />column: F_HF<br />row: B_HM","value: 1.0000000<br />column: B_HM<br />row: B_HM"]],"colorscale":[[0,"#440154"],[0.0169608779690677,"#46075B"],[0.0191187386442862,"#46085C"],[0.0197849034040161,"#46085C"],[0.0198768628681361,"#46085C"],[0.0277030916096895,"#460B5E"],[0.0350689328062909,"#470E61"],[0.035223899966648,"#470E61"],[0.0389555614678108,"#471063"],[0.0394558231014426,"#471063"],[0.047550119761339,"#471365"],[0.0557805296974625,"#481668"],[0.0755359530955524,"#481C6E"],[0.0787472832021132,"#481D6F"],[0.0807503529834963,"#481E70"],[0.0860028178241922,"#482071"],[0.0890626702788769,"#482172"],[0.0922866507659413,"#482274"],[0.0939436652336554,"#482374"],[0.0989967955556741,"#482475"],[0.109963675001581,"#482878"],[0.11779384017798,"#472A7A"],[0.126231769715298,"#472D7B"],[0.128196179577629,"#472E7C"],[0.131283675361651,"#472E7C"],[0.145555484219675,"#46337F"],[0.148199344917274,"#463480"],[0.150108887777342,"#463480"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.5,8.5],"y":[0.5,8.5],"name":"99_d2628015b11351a19b3635798b4f4d1a","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#440256"],[0.0625,"#48196B"],[0.125,"#472E7C"],[0.1875,"#424086"],[0.25,"#3B528B"],[0.3125,"#33638D"],[0.375,"#2C728E"],[0.4375,"#26828E"],[0.5,"#21918C"],[0.5625,"#1FA088"],[0.625,"#28AE80"],[0.6875,"#3EBC73"],[0.75,"#5DC863"],[0.8125,"#82D34C"],[0.875,"#ABDC32"],[0.9375,"#D5E21A"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.2","0.4","0.6","0.8","1.0"],"tickvals":[0,0.25,0.5,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1.14626177219499,1.14626177219499,null,1.14626177219499,1.04675308271078,null,1.04675308271078,1.04675308271078,null,1.04675308271078,1.0290066280827,null,1.0290066280827,1.0290066280827,null,1.0290066280827,1.0035060271696,null,1.0035060271696,1.0035060271696,null,1.0035060271696,0,null,1.0035060271696,1.0035060271696,null,1.0035060271696,0,null,1.0290066280827,1.0290066280827,null,1.0290066280827,0,null,1.04675308271078,1.04675308271078,null,1.04675308271078,0],"y":[4.5,7.125,null,7.125,7.125,null,7.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,8,null,8,8],"text":["y: 1.1462618","y: 1.1462618",null,"y: 1.1462618","y: 1.1462618",null,"y: 1.0467531","y: 1.0467531",null,"y: 1.0467531","y: 1.0467531",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0035060","y: 1.0035060",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0290066","y: 1.0290066",null,"y: 1.0467531","y: 1.0467531",null,"y: 1.0467531","y: 1.0467531"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1.14626177219499,1.14626177219499,null,1.14626177219499,0.992197612794563,null,0.992197612794563,0.992197612794563,null,0.992197612794563,0,null,0.992197612794563,0.992197612794563,null,0.992197612794563,0.969932326162913,null,0.969932326162913,0.969932326162913,null,0.969932326162913,0,null,0.969932326162913,0.969932326162913,null,0.969932326162913,0.964890957338606,null,0.964890957338606,0.964890957338606,null,0.964890957338606,0,null,0.964890957338606,0.964890957338606,null,0.964890957338606,0],"y":[4.5,1.875,null,1.875,1.875,null,1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"text":["y: 1.1462618","y: 1.1462618",null,"y: 1.1462618","y: 1.1462618",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9921976","y: 0.9921976",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9699323","y: 0.9699323",null,"y: 0.9648910","y: 0.9648910",null,"y: 0.9648910","y: 0.9648910",null,"y: 0.9648910","y: 0.9648910",null,"y: 0.9648910","y: 0.9648910"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[1.14626177219499,0.992197612794563,0,0.969932326162913,0,0.964890957338606,0,0,1.04675308271078,1.0290066280827,1.0035060271696,0,0,0,0],"y":[4.5,1.875,1,2.75,2,3.5,3,4,7.125,6.25,5.5,5,6,7,8],"text":["y: 1.1462618","y: 0.9921976","y: 0.0000000","y: 0.9699323","y: 0.0000000","y: 0.9648910","y: 0.0000000","y: 0.0000000","y: 1.0467531","y: 1.0290066","y: 1.0035060","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["D_CF","C_CM","H_CF","G_CM","E_HM","A_HF","F_HF","B_HM"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,1.14626177219499],"ticktext":["0.0","0.3","0.6","0.9"],"tickvals":[0,0.3,0.6,0.9],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["D_CF","C_CM","H_CF","G_CM","E_HM","A_HF","F_HF","B_HM"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,1.14626177219499],"ticktext":["0.0","0.3","0.6","0.9"],"tickvals":[0,0.3,0.6,0.9],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","width":504,"height":360,"paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Pearson Correlation @ 25kb"},"attrs":{"38fa1378093e":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"38fa2da6cf6e":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"38fa78cd5841":{"alpha":1,"sizes":[10,100]},"38fa28b11d11":{"fill":{},"x":{},"y":{},"type":"ggplotly"},"38fa741a6046":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"38fa6fa6cf36":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>#We can see that all the humans cluster together, as do all the chimps. This is very good, despite the fact that the correlations are fairly low.

###Add columns to full.data to indicate species of discovery and number of individuals discovered in. These pieces of information are good to know about each of the hits generally, but can also be used to make decisions about filtering out certain classes of hits if variance is associated with any of these metrics.  
humNAs &lt;- rowSums(is.na(full.data[,1:157]))
chimpNAs &lt;- rowSums(is.na(full.data[,158:313]))
full.data$found_in_H &lt;- (4-humNAs/39) #Set a new column identifying number of humans hit was found in
full.data$found_in_C &lt;- (4-chimpNAs/39) #Set a new column identifying number of chimps hit was found in
full.data$disc_species &lt;- ifelse(full.data$found_in_C&gt;0&amp;full.data$found_in_H&gt;0, &quot;B&quot;, ifelse(full.data$found_in_C==0, &quot;H&quot;, &quot;C&quot;)) #Set a column identifying which species (H, C, or Both) the hit in question was identified in. Works with nested ifelses.
full.data$tot_indiv_IDd &lt;- full.data$found_in_C+full.data$found_in_H #Add a column specifying total number of individuals homer found the significant hit in.

###Add columns to the full.data for variances for hits discovered within each species, then look at variance across species as well. I&#39;m checking here to see if there is some kind of cutoff I should make for the significant hits--i.e., if the variance looks to drop off significantly after a hit is discovered in at least 2 individuals, this suggests possibly filtering out any hit only discovered in 1 individual.
select(full.data, &quot;A-21792_norm&quot;, &quot;B-28126_norm&quot;, &quot;E-28815_norm&quot;, &quot;F-28834_norm&quot;) %&gt;% apply(., 1, var) -&gt; full.data$Hvar
select(full.data, &quot;C-3649_norm&quot;, &quot;D-40300_norm&quot;, &quot;G-3624_norm&quot;, &quot;H-3651_norm&quot;) %&gt;% apply(., 1, var) -&gt; full.data$Cvar
select(full.data, &quot;A-21792_norm&quot;, &quot;B-28126_norm&quot;, &quot;E-28815_norm&quot;, &quot;F-28834_norm&quot;, &quot;C-3649_norm&quot;, &quot;D-40300_norm&quot;, &quot;G-3624_norm&quot;, &quot;H-3651_norm&quot;) %&gt;% apply(., 1, var) -&gt; full.data$ALLvar

myplot &lt;- data.frame(disc_species=full.data$disc_species, found_in_H=full.data$found_in_H, found_in_C=full.data$found_in_C, tot_indiv_IDd=full.data$tot_indiv_IDd, Hvar=full.data$Hvar, Cvar=full.data$Cvar, ALLvar=full.data$ALLvar)
ggplot(data=myplot, aes(group=tot_indiv_IDd, x=tot_indiv_IDd, y=ALLvar)) + geom_boxplot() + scale_y_continuous(limits=c(0, 1))</code></pre>
<pre><code>Warning: Removed 542533 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-7.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###From this, it would appear that variance drops off drastically after discovery in at least 4 individuals. Hence try repeating all of the QC analyses done above, but this time conditioned upon discovery in 4 individuals. Moving forward I will ultimately filter out all the hits that were not found in at least 4 individuals, though I sometimes check the full dataset as well just for sanity&#39;s sake. Repeating all QC with the condition of discovery in 4 individuals:
data.4 &lt;- filter(full.data, tot_indiv_IDd&gt;=4) #Enforcing this condition brings us down from ~1.5 million hits to ~150k hits.

###See how distributions look with condition of 4 individuals.
hist(data.4[,c(320:321, 324:325)]) #Human dist&#39;ns</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>hist(data.4[,c(322:323, 326:327)]) #Chimp dist&#39;ns</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-9.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Overall the distributions look fairly similar to before, with the bimodality seen before being much less stark here (especially in the chimp distributions; it&#39;s still more visible amongst the humans)

###Mean vs. variance plot with condition of 4 individuals:
meansdata4 &lt;- rowMeans(data.4[,320:327]) #Check mean against variance
varsdata4 &lt;- apply(data.4[,320:327], 1, var)
{plot(meansdata4, varsdata4, main=&quot;Mean vs. Variance in Homer-corrected contact frequency | 4&quot;, xlab = &quot;Mean Hi-C Contact Frequency&quot;, ylab=&quot;Variance in Hi-C Contact Frequency&quot;)
  abline(lm(meansdata4~varsdata4), col=&quot;red&quot;)}</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-10.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#Looks very similar to the same plot above for the whole dataset; with slightly fewer outliers in the top left of the plot and a different trend in the red line modeling the mean regressed upon the variance. Here, the line is fairly flat, perhaps trending slightly upwards, whereas the entire dataset sees it have a moderate negative slope. Overall, would really prefer there to be no relationship here.

###Now to do PCA on the data conditioned upon discovery in 4 individuals--would expect many of the same patterns here, perhaps with even stronger separation due to only grabbing hits that are shared by 4 individuals:
pca4 &lt;- prcomp(t(data.4[,320:327]), scale=TRUE, center=TRUE)
ggplot(data=as.data.frame(pca4$x), aes(x=PC1, y=PC2, shape=as.factor(meta.data$SP), color=as.factor(meta.data$Batch), size=2)) + geom_point() +labs(title=&quot;PCA on normalized Hi-C Contact Frequency&quot;) + guides(color=guide_legend(order=1), size=FALSE, shape=guide_legend(order=2)) + xlab(paste(&quot;PC1 (&quot;, 100*summary(pca4)$importance[2,1], &quot;% of variance)&quot;)) + ylab((paste(&quot;PC2 (&quot;, 100*summary(pca4)$importance[2,2], &quot;% of variance)&quot;))) #Metadata hasn&#39;t changed so use the same metadata from above. PCA shows a similar separation along species lines for PC1, with this time it representing 33.121% of the variance (up from 21.6% earlier). This is rather unsurprising, since we have subset down to hits that are more shared than the total set we had before.</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-11.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>barplot(summary(pca4)$importance[2,], xlab=&quot;PCs&quot;, ylab=&quot;Proportion of Variance Explained&quot;, main=&quot;PCA on normalized Hi-C contact frequency&quot;) #Scree plot showing all the PCs and the proportion of the variance they explain. This is similar to above, with no PCs beyond a 7th one, and the first PC taking the vast majority of the variance while the others hover near 12-15%. No variables in experimentation, library prep, sequencing batch, or anything else seem to correlate with these PCs.</code></pre>
<p><img src="figure/initial_QC.Rmd/Initial%20Hi-C%20Data%20Read-in%20and%20QC-12.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>###Heatmap clustering of these data after conditioning upon discovery in 4 individuals. Would expect to see the same clustering, with perhaps higher correlation values due to conditioning upon discovery in 4 individuals.
corheat4 &lt;- cor(data.4[,320:327], use=&quot;complete.obs&quot;, method=&quot;pearson&quot;) #Corheat for the full data set, and heatmap
colnames(corheat4) &lt;- c(&quot;A_HF&quot;, &quot;B_HM&quot;, &quot;C_CM&quot;, &quot;D_CF&quot;, &quot;E_HM&quot;, &quot;F_HF&quot;, &quot;G_CM&quot;, &quot;H_CF&quot;)
rownames(corheat4) &lt;- colnames(corheat4)
heatmaply(corheat4, main=&quot;Pairwise Pearson Correlation @ 25kb | 4&quot;, k_row=2, k_col=2, symm=TRUE, margins=c(50, 50, 30, 30))</code></pre>
<pre><code>We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`
We recommend that you use the dev version of ggplot2 with `ggplotly()`
Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="38fa24f01f23" style="width:504px;height:360px;" class="plotly html-widget"></div>
<script type="application/json" data-for="38fa24f01f23">{"x":{"data":[{"x":[4.6875,6.5,null,6.5,6.5,null,6.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8],"y":[0.887700064783008,0.887700064783008,null,0.887700064783008,0.286826551579824,null,0.286826551579824,0.286826551579824,null,0.286826551579824,0.251311654867421,null,0.251311654867421,0.251311654867421,null,0.251311654867421,0,null,0.251311654867421,0.251311654867421,null,0.251311654867421,0,null,0.286826551579824,0.286826551579824,null,0.286826551579824,0.258761024745008,null,0.258761024745008,0.258761024745008,null,0.258761024745008,0,null,0.258761024745008,0.258761024745008,null,0.258761024745008,0],"text":["y: 0.8877001","y: 0.8877001",null,"y: 0.8877001","y: 0.8877001",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2587610","y: 0.2587610",null,"y: 0.2587610","y: 0.2587610",null,"y: 0.2587610","y: 0.2587610",null,"y: 0.2587610","y: 0.2587610"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.6875,2.875,null,2.875,2.875,null,2.875,1.75,null,1.75,1.75,null,1.75,1,null,1,1,null,1.75,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,2.875,4,null,4,4],"y":[0.887700064783008,0.887700064783008,null,0.887700064783008,0.240239047261391,null,0.240239047261391,0.240239047261391,null,0.240239047261391,0.233614109371964,null,0.233614109371964,0.233614109371964,null,0.233614109371964,0,null,0.233614109371964,0.233614109371964,null,0.233614109371964,0.217994694951224,null,0.217994694951224,0.217994694951224,null,0.217994694951224,0,null,0.217994694951224,0.217994694951224,null,0.217994694951224,0,null,0.240239047261391,0.240239047261391,null,0.240239047261391,0],"text":["y: 0.8877001","y: 0.8877001",null,"y: 0.8877001","y: 0.8877001",null,"y: 0.2402390","y: 0.2402390",null,"y: 0.2402390","y: 0.2402390",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2402390","y: 0.2402390",null,"y: 0.2402390","y: 0.2402390"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.6875,2.875,1.75,1,2.5,2,3,4,6.5,5.5,5,6,7.5,7,8],"y":[0.887700064783008,0.240239047261391,0.233614109371964,0,0.217994694951224,0,0,0,0.286826551579824,0.251311654867421,0,0,0.258761024745008,0,0],"text":["y: 0.8877001","y: 0.2402390","y: 0.2336141","y: 0.0000000","y: 0.2179947","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.2868266","y: 0.2513117","y: 0.0000000","y: 0.0000000","y: 0.2587610","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(214,39,40,1)","line":{"color":"transparent"}},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8],"y":[1,2,3,4,5,6,7,8],"z":[[1,0.646416816508636,0.633747885306658,0.621462550032254,0.0988575037053772,0.101286230448045,0.0604033884612156,0.0331215398939739],[0.646416816508636,1,0.660000288675843,0.630730038367662,0.130139143687289,0.108027494779068,0.0598085467706043,0.0337974307788752],[0.633747885306658,0.660000288675843,1,0.629217315706925,0.0905222860477844,0.0678370695735274,0.0250835407549875,0],[0.621462550032254,0.630730038367662,0.629217315706925,1,0.115473764637395,0.11852449388635,0.0603233240401326,0.016186972972291],[0.0988575037053772,0.130139143687289,0.0905222860477844,0.115473764637395,1,0.603960782669023,0.586779144354417,0.571101810940891],[0.101286230448045,0.108027494779068,0.0678370695735274,0.11852449388635,0.603960782669023,1,0.593338397675751,0.561936195153478],[0.0604033884612156,0.0598085467706043,0.0250835407549875,0.0603233240401326,0.586779144354417,0.593338397675751,1,0.59469053459274],[0.0331215398939739,0.0337974307788752,0,0.016186972972291,0.571101810940891,0.561936195153478,0.59469053459274,1]],"text":[["value: 1.0000000<br />column: H_CF<br />row: H_CF","value: 0.8416349<br />column: G_CM<br />row: H_CF","value: 0.8359607<br />column: C_CM<br />row: H_CF","value: 0.8304583<br />column: D_CF<br />row: H_CF","value: 0.5963907<br />column: E_HM<br />row: H_CF","value: 0.5974784<br />column: A_HF<br />row: H_CF","value: 0.5791676<br />column: B_HM<br />row: H_CF","value: 0.5669484<br />column: F_HF<br />row: H_CF"],["value: 0.8416349<br />column: H_CF<br />row: G_CM","value: 1.0000000<br />column: G_CM<br />row: G_CM","value: 0.8477188<br />column: C_CM<br />row: G_CM","value: 0.8346091<br />column: D_CF<br />row: G_CM","value: 0.6104013<br />column: E_HM<br />row: G_CM","value: 0.6004978<br />column: A_HF<br />row: G_CM","value: 0.5789012<br />column: B_HM<br />row: G_CM","value: 0.5672511<br />column: F_HF<br />row: G_CM"],["value: 0.8359607<br />column: H_CF<br />row: C_CM","value: 0.8477188<br />column: G_CM<br />row: C_CM","value: 1.0000000<br />column: C_CM<br />row: C_CM","value: 0.8339315<br />column: D_CF<br />row: C_CM","value: 0.5926574<br />column: E_HM<br />row: C_CM","value: 0.5824970<br />column: A_HF<br />row: C_CM","value: 0.5633483<br />column: B_HM<br />row: C_CM","value: 0.5521137<br />column: F_HF<br />row: C_CM"],["value: 0.8304583<br />column: H_CF<br />row: D_CF","value: 0.8346091<br />column: G_CM<br />row: D_CF","value: 0.8339315<br />column: C_CM<br />row: D_CF","value: 1.0000000<br />column: D_CF<br />row: D_CF","value: 0.6038328<br />column: E_HM<br />row: D_CF","value: 0.6051992<br />column: A_HF<br />row: D_CF","value: 0.5791317<br />column: B_HM<br />row: D_CF","value: 0.5593637<br />column: F_HF<br />row: D_CF"],["value: 0.5963907<br />column: H_CF<br />row: E_HM","value: 0.6104013<br />column: G_CM<br />row: E_HM","value: 0.5926574<br />column: C_CM<br />row: E_HM","value: 0.6038328<br />column: D_CF<br />row: E_HM","value: 1.0000000<br />column: E_HM<br />row: E_HM","value: 0.8226195<br />column: A_HF<br />row: E_HM","value: 0.8149241<br />column: B_HM<br />row: E_HM","value: 0.8079024<br />column: F_HF<br />row: E_HM"],["value: 0.5974784<br />column: H_CF<br />row: A_HF","value: 0.6004978<br />column: G_CM<br />row: A_HF","value: 0.5824970<br />column: C_CM<br />row: A_HF","value: 0.6051992<br />column: D_CF<br />row: A_HF","value: 0.8226195<br />column: E_HM<br />row: A_HF","value: 1.0000000<br />column: A_HF<br />row: A_HF","value: 0.8178619<br />column: B_HM<br />row: A_HF","value: 0.8037972<br />column: F_HF<br />row: A_HF"],["value: 0.5791676<br />column: H_CF<br />row: B_HM","value: 0.5789012<br />column: G_CM<br />row: B_HM","value: 0.5633483<br />column: C_CM<br />row: B_HM","value: 0.5791317<br />column: D_CF<br />row: B_HM","value: 0.8149241<br />column: E_HM<br />row: B_HM","value: 0.8178619<br />column: A_HF<br />row: B_HM","value: 1.0000000<br />column: B_HM<br />row: B_HM","value: 0.8184675<br />column: F_HF<br />row: B_HM"],["value: 0.5669484<br />column: H_CF<br />row: F_HF","value: 0.5672511<br />column: G_CM<br />row: F_HF","value: 0.5521137<br />column: C_CM<br />row: F_HF","value: 0.5593637<br />column: D_CF<br />row: F_HF","value: 0.8079024<br />column: E_HM<br />row: F_HF","value: 0.8037972<br />column: A_HF<br />row: F_HF","value: 0.8184675<br />column: B_HM<br />row: F_HF","value: 1.0000000<br />column: F_HF<br />row: F_HF"]],"colorscale":[[0,"#440154"],[0.016186972972291,"#46075A"],[0.0250835407549875,"#460A5D"],[0.0331215398939739,"#470D60"],[0.0337974307788752,"#470E61"],[0.0598085467706043,"#481769"],[0.0603233240401326,"#481769"],[0.0604033884612156,"#481769"],[0.0678370695735274,"#481A6C"],[0.0905222860477844,"#482173"],[0.0988575037053772,"#482475"],[0.101286230448045,"#482576"],[0.108027494779068,"#482778"],[0.115473764637395,"#482979"],[0.11852449388635,"#472A7A"],[0.130139143687289,"#472E7C"],[0.561936195153478,"#1F9F88"],[0.571101810940891,"#1FA187"],[0.586779144354417,"#21A585"],[0.593338397675751,"#21A685"],[0.59469053459274,"#22A785"],[0.603960782669023,"#23A983"],[0.621462550032254,"#26AD81"],[0.629217315706925,"#28AE80"],[0.630730038367662,"#29AF7F"],[0.633747885306658,"#2AB07F"],[0.646416816508636,"#2EB37C"],[0.660000288675843,"#33B67A"],[1,"#FDE725"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.5,8.5],"y":[0.5,8.5],"name":"99_71e720178821f95ebe8ea1f94c5dd04a","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#46075B"],[0.0454545454545455,"#48186A"],[0.0909090909090907,"#482777"],[0.136363636363636,"#453581"],[0.181818181818182,"#414287"],[0.227272727272727,"#3C4F8A"],[0.272727272727273,"#365C8D"],[0.318181818181818,"#31678E"],[0.363636363636363,"#2C728E"],[0.409090909090909,"#287D8E"],[0.454545454545454,"#24878E"],[0.5,"#20928C"],[0.545454545454546,"#1E9D89"],[0.590909090909091,"#22A884"],[0.636363636363636,"#2DB27D"],[0.681818181818182,"#3EBC74"],[0.727272727272727,"#53C568"],[0.772727272727272,"#6CCD5A"],[0.818181818181818,"#87D549"],[0.863636363636364,"#A5DB36"],[0.909090909090909,"#C3DF23"],[0.954545454545454,"#E1E418"],[1,"#FDE725"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.6","0.7","0.8","0.9","1.0"],"tickvals":[0.090909090909091,0.318181818181818,0.545454545454546,0.772727272727273,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y2","frame":null},{"x":[0.887700064783008,0.887700064783008,null,0.887700064783008,0.286826551579824,null,0.286826551579824,0.286826551579824,null,0.286826551579824,0.251311654867421,null,0.251311654867421,0.251311654867421,null,0.251311654867421,0,null,0.251311654867421,0.251311654867421,null,0.251311654867421,0,null,0.286826551579824,0.286826551579824,null,0.286826551579824,0.258761024745008,null,0.258761024745008,0.258761024745008,null,0.258761024745008,0,null,0.258761024745008,0.258761024745008,null,0.258761024745008,0],"y":[4.6875,6.5,null,6.5,6.5,null,6.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8],"text":["y: 0.8877001","y: 0.8877001",null,"y: 0.8877001","y: 0.8877001",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2513117","y: 0.2513117",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2868266","y: 0.2868266",null,"y: 0.2587610","y: 0.2587610",null,"y: 0.2587610","y: 0.2587610",null,"y: 0.2587610","y: 0.2587610",null,"y: 0.2587610","y: 0.2587610"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(57,190,177,1)","dash":"solid"},"hoveron":"points","name":"(#39BEB1,solid,1)","legendgroup":"(#39BEB1,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.887700064783008,0.887700064783008,null,0.887700064783008,0.240239047261391,null,0.240239047261391,0.240239047261391,null,0.240239047261391,0.233614109371964,null,0.233614109371964,0.233614109371964,null,0.233614109371964,0,null,0.233614109371964,0.233614109371964,null,0.233614109371964,0.217994694951224,null,0.217994694951224,0.217994694951224,null,0.217994694951224,0,null,0.217994694951224,0.217994694951224,null,0.217994694951224,0,null,0.240239047261391,0.240239047261391,null,0.240239047261391,0],"y":[4.6875,2.875,null,2.875,2.875,null,2.875,1.75,null,1.75,1.75,null,1.75,1,null,1,1,null,1.75,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,2.875,4,null,4,4],"text":["y: 0.8877001","y: 0.8877001",null,"y: 0.8877001","y: 0.8877001",null,"y: 0.2402390","y: 0.2402390",null,"y: 0.2402390","y: 0.2402390",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2336141","y: 0.2336141",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2179947","y: 0.2179947",null,"y: 0.2402390","y: 0.2402390",null,"y: 0.2402390","y: 0.2402390"],"type":"scatter","mode":"lines","line":{"width":2.26771653543307,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","name":"(#E495A5,solid,1)","legendgroup":"(#E495A5,solid,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0.887700064783008,0.240239047261391,0.233614109371964,0,0.217994694951224,0,0,0,0.286826551579824,0.251311654867421,0,0,0.258761024745008,0,0],"y":[4.6875,2.875,1.75,1,2.5,2,3,4,6.5,5.5,5,6,7.5,7,8],"text":["y: 0.8877001","y: 0.2402390","y: 0.2336141","y: 0.0000000","y: 0.2179947","y: 0.0000000","y: 0.0000000","y: 0.0000000","y: 0.2868266","y: 0.2513117","y: 0.0000000","y: 0.0000000","y: 0.2587610","y: 0.0000000","y: 0.0000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.88976377952756,"color":"transparent"}},"hoveron":"points","name":"(NA,1)","legendgroup":"(NA,1)","showlegend":true,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["H_CF","G_CM","C_CM","D_CF","E_HM","A_HF","B_HM","F_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis2":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","type":"linear","autorange":false,"tickmode":"array","range":[0,0.887700064783008],"ticktext":["0.0","0.2","0.4","0.6","0.8"],"tickvals":[0,0.2,0.4,0.6,0.8],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"yaxis2":{"domain":[0,0.8],"type":"linear","autorange":false,"tickmode":"array","range":[0.5,8.5],"ticktext":["H_CF","G_CM","C_CM","D_CF","E_HM","A_HF","B_HM","F_HF"],"tickvals":[1,2,3,4,5,6,7,8],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0.8,1],"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"x","type":"linear","autorange":false,"tickmode":"array","range":[0,0.887700064783008],"ticktext":["0.0","0.2","0.4","0.6","0.8"],"tickvals":[0,0.2,0.4,0.6,0.8],"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"gridcolor":null,"gridwidth":0,"title":"","titlefont":{"color":null,"family":null,"size":0},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0.8,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.8,"y0":0,"y1":0.8},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.8,"x1":1,"y0":0,"y1":0.8}],"margin":{"t":30,"r":30,"b":50,"l":50},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","width":504,"height":360,"paper_bgcolor":"rgba(255,255,255,1)","title":"Pairwise Pearson Correlation @ 25kb | 4"},"attrs":{"38fa35ac9cda":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"38fa576dc7bd":{"colour":{},"shape":{},"size":{},"x":{},"y":{}},"38fa301a090f":{"alpha":1,"sizes":[10,100]},"38fa5b3cedaf":{"fill":{},"x":{},"y":{},"type":"ggplotly"},"38fa2fb6db3d":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"ggplotly"},"38fadf39a44":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"modeBarButtonsToAdd":[],"cloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"subplot":true,"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>#Indeed, we can again see that all the humans cluster together, as do all the chimps. This is very good, and given this new condition, we also see higher within-species correlations for the significant hits, in the 0.8-0.9 range (was much closer to 0.6 before).

###This initial QC suggest quality of the data is high, and has given us some information on how to filter the data before further intrepretation. When working locally, can be helpful to write out both the full dataset and the one conditioned upon 4 individuals, in order to do sanity checks on both later on. Note that a call of identical on something fread in after fwriting it out will still return FALSE with this as floating point can&#39;t represent decimals exactly (see https://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal or https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f):
fwrite(full.data, &quot;~/Desktop/Hi-C/full.data.Oct17&quot;, quote = TRUE, sep = &quot;\t&quot;, row.names = FALSE, col.names = TRUE, na=&quot;NA&quot;)</code></pre>
<pre><code>
Written 37.4% of 1459352 rows in 2 secs using 8 threads. anyBufferGrown=no; maxBuffUsed=45%. Finished in 3 secs.      
Written 67.1% of 1459352 rows in 3 secs using 8 threads. anyBufferGrown=no; maxBuffUsed=45%. Finished in 1 secs.      
Written 98.3% of 1459352 rows in 4 secs using 8 threads. anyBufferGrown=no; maxBuffUsed=45%. Finished in 0 secs.      
                                                                                                                                     </code></pre>
<pre class="r"><code>fwrite(data.4, &quot;~/Desktop/Hi-C/data.4.Oct17&quot;, quote=FALSE, sep=&quot;\t&quot;, row.names=FALSE, col.names=TRUE, na=&quot;NA&quot;)</code></pre>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<!-- Insert the session information into the document -->
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.4.0 (2017-04-21)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: OS X El Capitan 10.11.6

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] compiler  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] bindrcpp_0.2       bedr_1.0.3         purrr_0.2.2.2     
 [4] readr_1.1.1        tibble_1.3.3       tidyverse_1.1.1   
 [7] edgeR_3.18.1       RColorBrewer_1.1-2 heatmaply_0.10.1  
[10] viridis_0.4.0      viridisLite_0.2.0  stringr_1.2.0     
[13] gplots_3.0.1       Hmisc_4.0-3        Formula_1.2-2     
[16] survival_2.41-3    lattice_0.20-35    dplyr_0.7.2       
[19] plotly_4.7.0       ggplot2_2.2.1      reshape2_1.4.2    
[22] data.table_1.10.4  tidyr_0.6.3        plyr_1.8.4        
[25] limma_3.32.4      

loaded via a namespace (and not attached):
 [1] colorspace_1.3-2     class_7.3-14         modeltools_0.2-21   
 [4] mclust_5.3           rprojroot_1.2        htmlTable_1.9       
 [7] futile.logger_1.4.3  base64enc_0.1-3      rstudioapi_0.7      
[10] flexmix_2.3-14       mvtnorm_1.0-6        lubridate_1.6.0     
[13] xml2_1.1.1           codetools_0.2-15     splines_3.4.0       
[16] R.methodsS3_1.7.1    mnormt_1.5-5         robustbase_0.92-7   
[19] knitr_1.17           jsonlite_1.5         broom_0.4.2         
[22] cluster_2.0.6        kernlab_0.9-25       R.oo_1.21.0         
[25] shiny_1.0.3          httr_1.3.1           backports_1.1.0     
[28] assertthat_0.2.0     Matrix_1.2-10        lazyeval_0.2.0      
[31] acepack_1.4.1        htmltools_0.3.6      tools_3.4.0         
[34] gtable_0.2.0         glue_1.1.1           Rcpp_0.12.12        
[37] cellranger_1.1.0     trimcluster_0.1-2    gdata_2.18.0        
[40] nlme_3.1-131         iterators_1.0.8      fpc_2.1-10          
[43] crosstalk_1.0.0      psych_1.7.5          testthat_1.0.2      
[46] rvest_0.3.2          mime_0.5             gtools_3.5.0        
[49] dendextend_1.5.2     DEoptimR_1.0-8       MASS_7.3-47         
[52] scales_0.4.1         TSP_1.1-5            hms_0.3             
[55] parallel_3.4.0       lambda.r_1.2         yaml_2.1.14         
[58] gridExtra_2.2.1      rpart_4.1-11         latticeExtra_0.6-28 
[61] stringi_1.1.5        gclus_1.3.1          foreach_1.4.3       
[64] checkmate_1.8.3      seriation_1.2-2      caTools_1.17.1      
[67] rlang_0.1.1          pkgconfig_2.0.1      prabclus_2.2-6      
[70] bitops_1.0-6         evaluate_0.10.1      bindr_0.1           
[73] htmlwidgets_0.9      labeling_0.3         magrittr_1.5        
[76] R6_2.2.2             haven_1.1.0          whisker_0.3-2       
[79] foreign_0.8-69       nnet_7.3-12          modelr_0.1.1        
[82] crayon_1.3.4         futile.options_1.0.0 KernSmooth_2.23-15  
[85] rmarkdown_1.6        locfit_1.5-9.1       grid_3.4.0          
[88] readxl_1.0.0         git2r_0.19.0         forcats_0.2.0       
[91] digest_0.6.12        diptest_0.75-7       xtable_1.8-2        
[94] VennDiagram_1.6.17   httpuv_1.3.5         R.utils_2.5.0       
[97] stats4_3.4.0         munsell_0.4.3        registry_0.3        </code></pre>
</div>

<hr>
<p>
    This <a href="http://rmarkdown.rstudio.com">R Markdown</a> site was created with <a href="https://github.com/jdblischak/workflowr">workflowr</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
